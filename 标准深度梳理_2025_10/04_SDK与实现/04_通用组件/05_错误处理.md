# 错误处理

## 📋 目录

- [错误处理](#错误处理)
  - [📋 目录](#-目录)
  - [概述](#概述)
  - [全局错误处理器](#全局错误处理器)
  - [Go 1.25.1 实现](#go-1251-实现)
  - [最佳实践](#最佳实践)
  - [参考资源](#参考资源)

---

## 概述

**Error Handler** 处理 OpenTelemetry SDK 内部错误。

---

## 全局错误处理器

```go
import "go.opentelemetry.io/otel"

func init() {
    otel.SetErrorHandler(otel.ErrorHandlerFunc(func(err error) {
        log.Printf("OpenTelemetry error: %v", err)
    }))
}
```

---

## Go 1.25.1 实现

```go
type CustomErrorHandler struct {
    logger *slog.Logger
}

func (h *CustomErrorHandler) Handle(err error) {
    h.logger.Error("OTEL error",
        "error", err,
        "type", fmt.Sprintf("%T", err),
    )
}

func init() {
    handler := &CustomErrorHandler{
        logger: slog.Default(),
    }
    otel.SetErrorHandler(handler)
}
```

---

## 最佳实践

```go
// ✅ 记录错误但不中断应用
otel.SetErrorHandler(otel.ErrorHandlerFunc(func(err error) {
    log.Printf("OTEL error: %v", err)
}))

// ❌ 不要 panic
otel.SetErrorHandler(otel.ErrorHandlerFunc(func(err error) {
    panic(err) // 错误
}))
```

---

## 参考资源

- [OpenTelemetry Error Handling](https://opentelemetry.io/docs/specs/otel/error-handling/)

---

**🎉 完成！错误处理知识掌握！**

**🎊🎊🎊 Phase 4.4: 通用组件 全部完成！🎊🎊🎊**-

**🎉🎉🎉 Milestone 4: SDK与实现 全部 20 个文档完成！🎉🎉🎉**-
