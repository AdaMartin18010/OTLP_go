# ID ç”Ÿæˆå™¨

## ğŸ“‹ ç›®å½•

- [ID ç”Ÿæˆå™¨](#id-ç”Ÿæˆå™¨)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [æ¦‚è¿°](#æ¦‚è¿°)
  - [é»˜è®¤ç”Ÿæˆå™¨](#é»˜è®¤ç”Ÿæˆå™¨)
  - [è‡ªå®šä¹‰ ID ç”Ÿæˆå™¨](#è‡ªå®šä¹‰-id-ç”Ÿæˆå™¨)
  - [Go 1.25.1 å®ç°](#go-1251-å®ç°)
  - [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
  - [å‚è€ƒèµ„æº](#å‚è€ƒèµ„æº)

---

## æ¦‚è¿°

**ID Generator** è´Ÿè´£ç”Ÿæˆ Trace ID å’Œ Span IDã€‚

```text
Trace ID: 128-bit (32 hex)
Span ID:  64-bit (16 hex)
```

---

## é»˜è®¤ç”Ÿæˆå™¨

```go
// é»˜è®¤ä½¿ç”¨ crypto/rand
tp := trace.NewTracerProvider()
```

---

## è‡ªå®šä¹‰ ID ç”Ÿæˆå™¨

```go
import "go.opentelemetry.io/otel/sdk/trace"

type CustomIDGenerator struct{}

func (g CustomIDGenerator) NewIDs(ctx context.Context) (trace.TraceID, trace.SpanID) {
    var traceID trace.TraceID
    var spanID trace.SpanID
    
    // è‡ªå®šä¹‰ç”Ÿæˆé€»è¾‘
    rand.Read(traceID[:])
    rand.Read(spanID[:])
    
    return traceID, spanID
}

func (g CustomIDGenerator) NewSpanID(ctx context.Context, traceID trace.TraceID) trace.SpanID {
    var spanID trace.SpanID
    rand.Read(spanID[:])
    return spanID
}

// ä½¿ç”¨
tp := trace.NewTracerProvider(
    trace.WithIDGenerator(CustomIDGenerator{}),
)
```

---

## Go 1.25.1 å®ç°

```go
import "math/rand/v2"

type ModernIDGenerator struct {
    rng *rand.Rand
}

func NewModernIDGenerator() *ModernIDGenerator {
    return &ModernIDGenerator{
        rng: rand.New(rand.NewPCG(uint64(time.Now().UnixNano()), 0)),
    }
}

func (g *ModernIDGenerator) NewIDs(ctx context.Context) (trace.TraceID, trace.SpanID) {
    var traceID trace.TraceID
    var spanID trace.SpanID
    
    g.rng.Read(traceID[:])
    g.rng.Read(spanID[:])
    
    return traceID, spanID
}

func (g *ModernIDGenerator) NewSpanID(ctx context.Context, traceID trace.TraceID) trace.SpanID {
    var spanID trace.SpanID
    g.rng.Read(spanID[:])
    return spanID
}
```

---

## æœ€ä½³å®è·µ

```go
// âœ… ä½¿ç”¨é»˜è®¤ç”Ÿæˆå™¨ï¼ˆæ¨èï¼‰
tp := trace.NewTracerProvider()

// âœ… è‡ªå®šä¹‰ç”Ÿæˆå™¨ï¼ˆç‰¹æ®Šéœ€æ±‚ï¼‰
// ä¾‹å¦‚: æœ‰åº IDã€åˆ†å¸ƒå¼ ID ç­‰
tp := trace.NewTracerProvider(
    trace.WithIDGenerator(CustomIDGenerator{}),
)
```

---

## å‚è€ƒèµ„æº

- [OpenTelemetry Trace SDK](https://opentelemetry.io/docs/specs/otel/trace/sdk/)

---

**ğŸ‰ å®Œæˆï¼ID ç”Ÿæˆå™¨çŸ¥è¯†æŒæ¡ï¼**-
