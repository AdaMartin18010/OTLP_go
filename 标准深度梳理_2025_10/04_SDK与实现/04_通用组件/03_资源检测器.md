# èµ„æºæ£€æµ‹å™¨

## ğŸ“‹ ç›®å½•

- [èµ„æºæ£€æµ‹å™¨](#èµ„æºæ£€æµ‹å™¨)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [æ¦‚è¿°](#æ¦‚è¿°)
  - [å†…ç½®æ£€æµ‹å™¨](#å†…ç½®æ£€æµ‹å™¨)
  - [ç»„åˆæ£€æµ‹å™¨](#ç»„åˆæ£€æµ‹å™¨)
  - [Go 1.25.1 å®ç°](#go-1251-å®ç°)
    - [1. è‡ªå®šä¹‰æ£€æµ‹å™¨](#1-è‡ªå®šä¹‰æ£€æµ‹å™¨)
    - [2. æ¡ä»¶æ£€æµ‹](#2-æ¡ä»¶æ£€æµ‹)
  - [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
  - [å‚è€ƒèµ„æº](#å‚è€ƒèµ„æº)

---

## æ¦‚è¿°

**Resource Detector** è‡ªåŠ¨æ£€æµ‹è¿è¡Œç¯å¢ƒå¹¶ç”Ÿæˆ Resource å±æ€§ã€‚

---

## å†…ç½®æ£€æµ‹å™¨

```go
import (
    "go.opentelemetry.io/otel/sdk/resource"
    semconv "go.opentelemetry.io/otel/semconv/v1.21.0"
)

func newResource() *resource.Resource {
    return resource.NewWithAttributes(
        semconv.SchemaURL,
        semconv.ServiceName("myapp"),
        semconv.ServiceVersion("1.0.0"),
    )
}
```

**ç¯å¢ƒå˜é‡æ£€æµ‹**:

```go
// è‡ªåŠ¨ä» OTEL_RESOURCE_ATTRIBUTES è¯»å–
// export OTEL_RESOURCE_ATTRIBUTES="service.name=myapp,deployment.environment=prod"

r, _ := resource.New(context.Background(),
    resource.WithFromEnv(), // è¯»å–ç¯å¢ƒå˜é‡
)
```

---

## ç»„åˆæ£€æµ‹å™¨

```go
r, _ := resource.New(
    context.Background(),
    resource.WithFromEnv(),      // ç¯å¢ƒå˜é‡
    resource.WithHost(),         // ä¸»æœºä¿¡æ¯
    resource.WithProcess(),      // è¿›ç¨‹ä¿¡æ¯
    resource.WithContainer(),    // å®¹å™¨ä¿¡æ¯
    resource.WithOS(),           // æ“ä½œç³»ç»Ÿ
    resource.WithAttributes(     // è‡ªå®šä¹‰å±æ€§
        semconv.ServiceName("myapp"),
    ),
)
```

---

## Go 1.25.1 å®ç°

### 1. è‡ªå®šä¹‰æ£€æµ‹å™¨

```go
type CustomDetector struct{}

func (d CustomDetector) Detect(ctx context.Context) (*resource.Resource, error) {
    return resource.NewWithAttributes(
        semconv.SchemaURL,
        attribute.String("custom.key", "value"),
    ), nil
}

// ä½¿ç”¨
r, _ := resource.New(
    context.Background(),
    resource.WithDetectors(CustomDetector{}),
)
```

### 2. æ¡ä»¶æ£€æµ‹

```go
func newResource() *resource.Resource {
    detectors := []resource.Detector{
        resource.FromEnv(),
    }
    
    // ä»…åœ¨ Kubernetes ä¸­æ·»åŠ  K8s æ£€æµ‹å™¨
    if isKubernetes() {
        detectors = append(detectors, kubernetesDetector{})
    }
    
    r, _ := resource.New(
        context.Background(),
        resource.WithDetectors(detectors...),
    )
    return r
}
```

---

## æœ€ä½³å®è·µ

```go
// âœ… æ¨èé…ç½®
r, _ := resource.New(
    context.Background(),
    resource.WithFromEnv(),
    resource.WithHost(),
    resource.WithProcess(),
    resource.WithAttributes(
        semconv.ServiceName("myapp"),
        semconv.ServiceVersion("1.0.0"),
    ),
)
```

---

## å‚è€ƒèµ„æº

- [OpenTelemetry Resource SDK](https://opentelemetry.io/docs/specs/otel/resource/sdk/)

---

**ğŸ‰ å®Œæˆï¼èµ„æºæ£€æµ‹å™¨çŸ¥è¯†æŒæ¡ï¼**
