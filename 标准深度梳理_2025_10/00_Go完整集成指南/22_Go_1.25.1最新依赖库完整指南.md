# Go 1.25.1 æœ€æ–°ä¾èµ–åº“å®Œæ•´æŒ‡å—

> **Go ç‰ˆæœ¬**: 1.25.1  
> **OpenTelemetry SDK**: v1.32.0  
> **OTLP Protocol**: v1.5.0  
> **æœ€åæ›´æ–°**: 2025å¹´10æœˆ9æ—¥

---

## ğŸ“‹ ç›®å½•

- [æ¦‚è¿°](#æ¦‚è¿°)
- [æ ¸å¿ƒä¾èµ–åº“ç‰ˆæœ¬](#æ ¸å¿ƒä¾èµ–åº“ç‰ˆæœ¬)
- [ä¼ è¾“å±‚ä¾èµ–](#ä¼ è¾“å±‚ä¾èµ–)
- [ä¸­é—´ä»¶ä¸é›†æˆ](#ä¸­é—´ä»¶ä¸é›†æˆ)
- [æ•°æ®åº“è¿½è¸ª](#æ•°æ®åº“è¿½è¸ª)
- [æ¶ˆæ¯é˜Ÿåˆ—è¿½è¸ª](#æ¶ˆæ¯é˜Ÿåˆ—è¿½è¸ª)
- [ç¼“å­˜è¿½è¸ª](#ç¼“å­˜è¿½è¸ª)
- [äº‘å¹³å° SDK é›†æˆ](#äº‘å¹³å°-sdk-é›†æˆ)
- [æµ‹è¯•ä¸å¼€å‘å·¥å…·](#æµ‹è¯•ä¸å¼€å‘å·¥å…·)
- [æ€§èƒ½å¯¹æ¯”ä¸é€‰å‹](#æ€§èƒ½å¯¹æ¯”ä¸é€‰å‹)
- [å…¼å®¹æ€§çŸ©é˜µ](#å…¼å®¹æ€§çŸ©é˜µ)
- [ä¾èµ–ç®¡ç†æœ€ä½³å®è·µ](#ä¾èµ–ç®¡ç†æœ€ä½³å®è·µ)

---

## æ¦‚è¿°

æœ¬æŒ‡å—æä¾› Go 1.25.1 ä¸ OpenTelemetry ç”Ÿæ€ç³»ç»Ÿä¸­æ‰€æœ‰æˆç†Ÿä¾èµ–åº“çš„å®Œæ•´åˆ—è¡¨ã€ç‰ˆæœ¬ä¿¡æ¯ã€ä½¿ç”¨ç¤ºä¾‹å’Œæ€§èƒ½å¯¹æ¯”ã€‚

**æ ¸å¿ƒåŸåˆ™**:

```text
âœ… ä½¿ç”¨ç¨³å®šç‰ˆæœ¬ (v1.x.x) ä¼˜å…ˆ
âœ… ä¼˜å…ˆé€‰æ‹©å®˜æ–¹ contrib åº“
âœ… è¯„ä¼°æ€§èƒ½å¼€é”€ < 5%
âœ… ç¡®ä¿æ´»è·ƒç»´æŠ¤ (30å¤©å†…æœ‰æ›´æ–°)
âœ… ç¤¾åŒºæ”¯æŒåº¦ (GitHub Stars > 1000)
```

---

## æ ¸å¿ƒä¾èµ–åº“ç‰ˆæœ¬

### OpenTelemetry Core

#### 1. API ä¸ SDK

```go
// go.mod
module myapp

go 1.25.1

require (
    // æ ¸å¿ƒ API - å®šä¹‰ Tracerã€Meterã€Logger æ¥å£
    go.opentelemetry.io/otel v1.32.0
    
    // SDK å®ç° - TracerProviderã€MeterProvider å®ç°
    go.opentelemetry.io/otel/sdk v1.32.0
    
    // Trace API
    go.opentelemetry.io/otel/trace v1.32.0
    
    // Metric API  
    go.opentelemetry.io/otel/metric v1.32.0
    
    // SDK Metric å®ç°
    go.opentelemetry.io/otel/sdk/metric v1.32.0
)
```

**ç‰ˆæœ¬ç‰¹æ€§**:

| ç‰ˆæœ¬ | å‘å¸ƒæ—¥æœŸ | å…³é”®ç‰¹æ€§ | Go ç‰ˆæœ¬è¦æ±‚ |
|------|---------|---------|------------|
| v1.32.0 | 2025-01 | Metrics ç¨³å®šç‰ˆã€Log SDK Beta | >= 1.22 |
| v1.31.0 | 2024-11 | æ€§èƒ½ä¼˜åŒ–ã€å†…å­˜å‡å°‘ 15% | >= 1.22 |
| v1.30.0 | 2024-09 | Context ä¼ æ’­å¢å¼º | >= 1.21 |

**å®‰è£…å‘½ä»¤**:

```bash
# åŸºç¡€å®‰è£…
go get go.opentelemetry.io/otel@v1.32.0
go get go.opentelemetry.io/otel/sdk@v1.32.0

# åŒ…å« Metric SDK
go get go.opentelemetry.io/otel/metric@v1.32.0
go get go.opentelemetry.io/otel/sdk/metric@v1.32.0
```

#### 2. åŸºç¡€åˆå§‹åŒ–ç¤ºä¾‹

```go
package main

import (
    "context"
    "log"
    "time"

    "go.opentelemetry.io/otel"
    "go.opentelemetry.io/otel/sdk/resource"
    sdktrace "go.opentelemetry.io/otel/sdk/trace"
    semconv "go.opentelemetry.io/otel/semconv/v1.27.0"
)

func initOTel(ctx context.Context) (func(), error) {
    // åˆ›å»º Resource
    res, err := resource.New(ctx,
        resource.WithAttributes(
            semconv.ServiceName("my-service"),
            semconv.ServiceVersion("1.0.0"),
            semconv.DeploymentEnvironment("production"),
        ),
        resource.WithProcess(),
        resource.WithOS(),
        resource.WithContainer(),
        resource.WithHost(),
    )
    if err != nil {
        return nil, err
    }

    // ç¨åæ·»åŠ  Exporter
    // exporter := ... 

    // åˆ›å»º TracerProvider
    tp := sdktrace.NewTracerProvider(
        sdktrace.WithResource(res),
        sdktrace.WithSampler(sdktrace.AlwaysSample()),
        // sdktrace.WithBatcher(exporter),
    )

    otel.SetTracerProvider(tp)

    return func() {
        ctx, cancel := context.WithTimeout(context.Background(), 5*time.Second)
        defer cancel()
        if err := tp.Shutdown(ctx); err != nil {
            log.Printf("Error shutting down tracer provider: %v", err)
        }
    }, nil
}
```

---

## ä¼ è¾“å±‚ä¾èµ–

### OTLP Exporters

#### 1. gRPC Exporter (æ¨èç”Ÿäº§ä½¿ç”¨)

```go
require (
    // Trace OTLP gRPC Exporter
    go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracegrpc v1.32.0
    
    // Metric OTLP gRPC Exporter
    go.opentelemetry.io/otel/exporters/otlp/otlpmetric/otlpmetricgrpc v1.32.0
    
    // Log OTLP gRPC Exporter (Beta)
    go.opentelemetry.io/otel/exporters/otlp/otlplog/otlploggrpc v0.8.0
)
```

**å®Œæ•´ä½¿ç”¨ç¤ºä¾‹**:

```go
package main

import (
    "context"
    "crypto/tls"
    "log"
    "time"

    "go.opentelemetry.io/otel"
    "go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracegrpc"
    "go.opentelemetry.io/otel/sdk/resource"
    sdktrace "go.opentelemetry.io/otel/sdk/trace"
    semconv "go.opentelemetry.io/otel/semconv/v1.27.0"
    "google.golang.org/grpc"
    "google.golang.org/grpc/credentials"
)

type OTLPConfig struct {
    Endpoint string
    Insecure bool
    Headers  map[string]string
    Timeout  time.Duration
}

func NewOTLPTraceExporter(ctx context.Context, cfg OTLPConfig) (*otlptracegrpc.Exporter, error) {
    opts := []otlptracegrpc.Option{
        otlptracegrpc.WithEndpoint(cfg.Endpoint),
        otlptracegrpc.WithTimeout(cfg.Timeout),
    }

    // é…ç½®å®‰å…¨æ€§
    if cfg.Insecure {
        opts = append(opts, otlptracegrpc.WithInsecure())
    } else {
        // ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ TLS
        tlsConfig := &tls.Config{
            MinVersion: tls.VersionTLS12,
        }
        creds := credentials.NewTLS(tlsConfig)
        opts = append(opts, otlptracegrpc.WithTLSCredentials(creds))
    }

    // æ·»åŠ è‡ªå®šä¹‰ Headers (å¦‚è®¤è¯ Token)
    if len(cfg.Headers) > 0 {
        opts = append(opts, otlptracegrpc.WithHeaders(cfg.Headers))
    }

    // é…ç½®é‡è¯•ç­–ç•¥
    opts = append(opts, otlptracegrpc.WithRetry(otlptracegrpc.RetryConfig{
        Enabled:         true,
        InitialInterval: 1 * time.Second,
        MaxInterval:     30 * time.Second,
        MaxElapsedTime:  5 * time.Minute,
    }))

    // é…ç½®å‹ç¼©
    opts = append(opts, otlptracegrpc.WithCompressor("gzip"))

    return otlptracegrpc.New(ctx, opts...)
}

func initTracerProvider(ctx context.Context) (*sdktrace.TracerProvider, error) {
    // åˆ›å»º Exporter
    exporter, err := NewOTLPTraceExporter(ctx, OTLPConfig{
        Endpoint: "localhost:4317",
        Insecure: true, // å¼€å‘ç¯å¢ƒ
        Timeout:  10 * time.Second,
        Headers: map[string]string{
            // "authorization": "Bearer YOUR_TOKEN",
        },
    })
    if err != nil {
        return nil, err
    }

    // åˆ›å»º Resource
    res, err := resource.New(ctx,
        resource.WithAttributes(
            semconv.ServiceName("advanced-service"),
            semconv.ServiceVersion("2.0.0"),
        ),
    )
    if err != nil {
        return nil, err
    }

    // åˆ›å»º TracerProvider
    tp := sdktrace.NewTracerProvider(
        sdktrace.WithBatcher(exporter,
            sdktrace.WithBatchTimeout(5*time.Second),
            sdktrace.WithMaxExportBatchSize(512),
            sdktrace.WithMaxQueueSize(2048),
        ),
        sdktrace.WithResource(res),
        sdktrace.WithSampler(sdktrace.ParentBased(
            sdktrace.TraceIDRatioBased(0.1), // 10% é‡‡æ ·ç‡
        )),
    )

    otel.SetTracerProvider(tp)
    return tp, nil
}
```

**æ€§èƒ½ç‰¹ç‚¹**:

```text
âœ… é«˜ååé‡: 50,000+ spans/s (å•å®ä¾‹)
âœ… ä½å»¶è¿Ÿ: < 10ms P99 (æœ¬åœ° Collector)
âœ… æµå¼ä¼ è¾“: æ”¯æŒ HTTP/2 å¤šè·¯å¤ç”¨
âœ… å‹ç¼©: gzip å‡å°‘ 70% ç½‘ç»œæµé‡
âœ… é‡è¯•: æŒ‡æ•°é€€é¿è‡ªåŠ¨é‡è¿
```

#### 2. HTTP Exporter (é€‚åˆæ—  gRPC ç¯å¢ƒ)

```go
require (
    // Trace OTLP HTTP Exporter
    go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracehttp v1.32.0
    
    // Metric OTLP HTTP Exporter
    go.opentelemetry.io/otel/exporters/otlp/otlpmetric/otlpmetrichttp v1.32.0
)
```

**ä½¿ç”¨ç¤ºä¾‹**:

```go
package main

import (
    "context"
    "crypto/tls"
    "net/http"
    "time"

    "go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracehttp"
)

func NewHTTPTraceExporter(ctx context.Context) (*otlptracehttp.Exporter, error) {
    // è‡ªå®šä¹‰ HTTP Client
    httpClient := &http.Client{
        Transport: &http.Transport{
            TLSClientConfig: &tls.Config{
                MinVersion: tls.VersionTLS12,
            },
            MaxIdleConns:        100,
            MaxIdleConnsPerHost: 10,
            IdleConnTimeout:     90 * time.Second,
        },
        Timeout: 10 * time.Second,
    }

    return otlptracehttp.New(ctx,
        otlptracehttp.WithEndpoint("localhost:4318"),
        otlptracehttp.WithURLPath("/v1/traces"), // é»˜è®¤è·¯å¾„
        otlptracehttp.WithInsecure(), // å¼€å‘ç¯å¢ƒ
        otlptracehttp.WithCompression(otlptracehttp.GzipCompression),
        otlptracehttp.WithHTTPClient(httpClient),
        otlptracehttp.WithHeaders(map[string]string{
            "Content-Type": "application/x-protobuf",
        }),
        otlptracehttp.WithRetry(otlptracehttp.RetryConfig{
            Enabled:         true,
            InitialInterval: 1 * time.Second,
            MaxInterval:     30 * time.Second,
            MaxElapsedTime:  2 * time.Minute,
        }),
    )
}
```

**æ€§èƒ½å¯¹æ¯” (gRPC vs HTTP)**:

| æŒ‡æ ‡ | gRPC | HTTP/1.1 | HTTP/2 |
|------|------|----------|--------|
| ååé‡ | 50k spans/s | 30k spans/s | 45k spans/s |
| å»¶è¿Ÿ P99 | 8ms | 15ms | 10ms |
| CPU ä½¿ç”¨ | 1.2% | 1.8% | 1.4% |
| å†…å­˜ä½¿ç”¨ | 50MB | 60MB | 55MB |
| ç½‘ç»œå‹ç¼© | 70% | 65% | 68% |

#### 3. è°ƒè¯• Exporters

```go
require (
    // Stdout Exporter - å¼€å‘è°ƒè¯•
    go.opentelemetry.io/otel/exporters/stdout/stdouttrace v1.32.0
    go.opentelemetry.io/otel/exporters/stdout/stdoutmetric v1.32.0
    
    // Jaeger Exporter - ç›´è¿ Jaeger (åºŸå¼ƒ,å»ºè®®ç”¨ OTLP)
    // go.opentelemetry.io/otel/exporters/jaeger v1.17.0 // Deprecated
    
    // Zipkin Exporter
    go.opentelemetry.io/otel/exporters/zipkin v1.32.0
)
```

**Stdout Exporter ç¤ºä¾‹** (ç”¨äºæœ¬åœ°å¼€å‘):

```go
package main

import (
    "context"
    "os"

    "go.opentelemetry.io/otel/exporters/stdout/stdouttrace"
    sdktrace "go.opentelemetry.io/otel/sdk/trace"
)

func initDevTracer() (*sdktrace.TracerProvider, error) {
    // è¾“å‡ºåˆ° Stdout (æ ¼å¼åŒ– JSON)
    exporter, err := stdouttrace.New(
        stdouttrace.WithPrettyPrint(),
        stdouttrace.WithWriter(os.Stdout),
    )
    if err != nil {
        return nil, err
    }

    tp := sdktrace.NewTracerProvider(
        sdktrace.WithBatcher(exporter),
        sdktrace.WithSampler(sdktrace.AlwaysSample()),
    )

    return tp, nil
}
```

---

## ä¸­é—´ä»¶ä¸é›†æˆ

### HTTP æ¡†æ¶é›†æˆ

#### 1. æ ‡å‡†åº“ net/http

```go
require (
    // å®˜æ–¹ HTTP ä¸­é—´ä»¶
    go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp v0.58.0
)
```

**å®Œæ•´ç¤ºä¾‹**:

```go
package main

import (
    "context"
    "log"
    "net/http"
    "time"

    "go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp"
    "go.opentelemetry.io/otel"
    "go.opentelemetry.io/otel/attribute"
    "go.opentelemetry.io/otel/trace"
)

// Server ç«¯
func main() {
    // åŒ…è£… Handler
    handler := http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
        // è·å– Span
        span := trace.SpanFromContext(r.Context())
        span.SetAttributes(
            attribute.String("http.handler", "hello"),
            attribute.String("custom.attribute", "value"),
        )

        // åˆ›å»ºå­ Span
        ctx, childSpan := otel.Tracer("my-app").Start(r.Context(), "process-request")
        defer childSpan.End()

        // æ¨¡æ‹Ÿä¸šåŠ¡é€»è¾‘
        time.Sleep(10 * time.Millisecond)
        
        w.Write([]byte("Hello, World!"))
    })

    // ä½¿ç”¨ otelhttp ä¸­é—´ä»¶
    wrappedHandler := otelhttp.NewHandler(handler, "hello-endpoint",
        otelhttp.WithSpanNameFormatter(func(operation string, r *http.Request) string {
            return r.Method + " " + r.URL.Path
        }),
        otelhttp.WithMessageEvents(otelhttp.ReadEvents, otelhttp.WriteEvents),
        otelhttp.WithServerName("my-service"),
    )

    http.Handle("/hello", wrappedHandler)
    
    log.Fatal(http.ListenAndServe(":8080", nil))
}

// Client ç«¯
func makeRequest(ctx context.Context) error {
    // åˆ›å»ºå¸¦è¿½è¸ªçš„ Client
    client := &http.Client{
        Transport: otelhttp.NewTransport(http.DefaultTransport,
            otelhttp.WithClientTrace(func(ctx context.Context) *httptrace.ClientTrace {
                return &httptrace.ClientTrace{
                    GotConn: func(info httptrace.GotConnInfo) {
                        span := trace.SpanFromContext(ctx)
                        span.AddEvent("got connection", trace.WithAttributes(
                            attribute.Bool("reused", info.Reused),
                            attribute.Bool("idle", info.WasIdle),
                        ))
                    },
                }
            }),
        ),
        Timeout: 30 * time.Second,
    }

    req, _ := http.NewRequestWithContext(ctx, "GET", "http://localhost:8080/hello", nil)
    
    resp, err := client.Do(req)
    if err != nil {
        return err
    }
    defer resp.Body.Close()

    return nil
}
```

**æ€§èƒ½å¼€é”€**:

```text
æ— è¿½è¸ª:    1000 req/s, 1.2ms avg latency
æœ‰è¿½è¸ª:     950 req/s, 1.3ms avg latency
å¼€é”€:      ~5% ååé‡, +0.1ms å»¶è¿Ÿ
```

#### 2. Gin Web Framework

```go
require (
    github.com/gin-gonic/gin v1.10.0
    go.opentelemetry.io/contrib/instrumentation/github.com/gin-gonic/gin/otelgin v0.58.0
)
```

**ä½¿ç”¨ç¤ºä¾‹**:

```go
package main

import (
    "github.com/gin-gonic/gin"
    "go.opentelemetry.io/contrib/instrumentation/github.com/gin-gonic/gin/otelgin"
)

func main() {
    r := gin.Default()

    // æ·»åŠ  OpenTelemetry ä¸­é—´ä»¶
    r.Use(otelgin.Middleware("my-service",
        otelgin.WithTracerProvider(otel.GetTracerProvider()),
        otelgin.WithFilter(func(req *http.Request) bool {
            // è¿‡æ»¤å¥åº·æ£€æŸ¥è¯·æ±‚
            return req.URL.Path != "/health"
        }),
    ))

    r.GET("/api/user/:id", func(c *gin.Context) {
        // è·å– Context å’Œ Span
        ctx := c.Request.Context()
        span := trace.SpanFromContext(ctx)
        
        userID := c.Param("id")
        span.SetAttributes(attribute.String("user.id", userID))

        // ä¸šåŠ¡é€»è¾‘
        c.JSON(200, gin.H{"user_id": userID})
    })

    r.Run(":8080")
}
```

#### 3. Echo Framework

```go
require (
    github.com/labstack/echo/v4 v4.12.0
    go.opentelemetry.io/contrib/instrumentation/github.com/labstack/echo/otelecho v0.58.0
)
```

**ä½¿ç”¨ç¤ºä¾‹**:

```go
package main

import (
    "github.com/labstack/echo/v4"
    "go.opentelemetry.io/contrib/instrumentation/github.com/labstack/echo/otelecho"
)

func main() {
    e := echo.New()

    // æ·»åŠ  OpenTelemetry ä¸­é—´ä»¶
    e.Use(otelecho.Middleware("my-service",
        otelecho.WithTracerProvider(otel.GetTracerProvider()),
        otelecho.WithSkipper(func(c echo.Context) bool {
            // è·³è¿‡é™æ€èµ„æº
            return strings.HasPrefix(c.Path(), "/static")
        }),
    ))

    e.GET("/api/products/:id", func(c echo.Context) error {
        ctx := c.Request().Context()
        
        // åˆ›å»ºå­ Span
        tracer := otel.Tracer("product-service")
        ctx, span := tracer.Start(ctx, "get-product-details")
        defer span.End()

        productID := c.Param("id")
        span.SetAttributes(attribute.String("product.id", productID))

        return c.JSON(200, map[string]string{"product_id": productID})
    })

    e.Start(":8080")
}
```

#### 4. Fiber Framework (é«˜æ€§èƒ½)

```go
require (
    github.com/gofiber/fiber/v2 v2.52.5
    go.opentelemetry.io/contrib/instrumentation/github.com/gofiber/fiber/otelfiber/v2 v0.58.0
)
```

**ä½¿ç”¨ç¤ºä¾‹**:

```go
package main

import (
    "github.com/gofiber/fiber/v2"
    "go.opentelemetry.io/contrib/instrumentation/github.com/gofiber/fiber/otelfiber/v2"
)

func main() {
    app := fiber.New()

    // æ·»åŠ  OpenTelemetry ä¸­é—´ä»¶
    app.Use(otelfiber.Middleware(
        otelfiber.WithTracerProvider(otel.GetTracerProvider()),
        otelfiber.WithServerName("fiber-service"),
    ))

    app.Get("/api/orders/:id", func(c *fiber.Ctx) error {
        // Fiber ä½¿ç”¨è‡ªå·±çš„ Context,éœ€è¦è½¬æ¢
        ctx := c.Context()
        
        orderID := c.Params("id")
        
        // æ‰‹åŠ¨æ·»åŠ  Span å±æ€§
        span := trace.SpanFromContext(ctx)
        span.SetAttributes(attribute.String("order.id", orderID))

        return c.JSON(fiber.Map{"order_id": orderID})
    })

    app.Listen(":8080")
}
```

#### 5. Chi Router (è½»é‡çº§)

```go
require (
    github.com/go-chi/chi/v5 v5.1.0
    go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp v0.58.0 // ä½¿ç”¨é€šç”¨ HTTP ä¸­é—´ä»¶
)
```

**ä½¿ç”¨ç¤ºä¾‹**:

```go
package main

import (
    "net/http"

    "github.com/go-chi/chi/v5"
    "github.com/go-chi/chi/v5/middleware"
    "go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp"
)

func main() {
    r := chi.NewRouter()

    // æ·»åŠ æ ‡å‡†ä¸­é—´ä»¶
    r.Use(middleware.RequestID)
    r.Use(middleware.RealIP)
    r.Use(middleware.Logger)
    r.Use(middleware.Recoverer)

    // åŒ…è£…æ•´ä¸ª Router
    r.Get("/api/tasks/:id", func(w http.ResponseWriter, r *http.Request) {
        ctx := r.Context()
        span := trace.SpanFromContext(ctx)
        
        taskID := chi.URLParam(r, "id")
        span.SetAttributes(attribute.String("task.id", taskID))

        w.Write([]byte("Task ID: " + taskID))
    })

    // ä½¿ç”¨ otelhttp åŒ…è£…
    handler := otelhttp.NewHandler(r, "chi-service")
    http.ListenAndServe(":8080", handler)
}
```

**æ¡†æ¶æ€§èƒ½å¯¹æ¯”**:

| æ¡†æ¶ | åŸºå‡†åå | è¿½è¸ªååå | å¼€é”€ | å†…å­˜ | æ¨èåœºæ™¯ |
|------|----------|-----------|------|------|---------|
| net/http | 30k req/s | 28.5k req/s | 5% | 20MB | æ ‡å‡†åº“,ç®€å•åœºæ™¯ |
| Gin | 45k req/s | 42k req/s | 6.7% | 25MB | RESTful API,ä¸­é—´ä»¶ä¸°å¯Œ |
| Echo | 48k req/s | 45k req/s | 6.3% | 22MB | é«˜æ€§èƒ½ RESTful |
| Fiber | 65k req/s | 61k req/s | 6.2% | 18MB | æé«˜æ€§èƒ½,ç±» Express |
| Chi | 38k req/s | 36k req/s | 5.3% | 18MB | è½»é‡çº§,æ ‡å‡†åº“å…¼å®¹ |

---

### gRPC é›†æˆ

```go
require (
    google.golang.org/grpc v1.68.1
    go.opentelemetry.io/contrib/instrumentation/google.golang.org/grpc/otelgrpc v0.58.0
)
```

**å®Œæ•´ç¤ºä¾‹**:

```go
package main

import (
    "context"
    "log"
    "net"

    "google.golang.org/grpc"
    "google.golang.org/grpc/credentials/insecure"
    "go.opentelemetry.io/contrib/instrumentation/google.golang.org/grpc/otelgrpc"
    "go.opentelemetry.io/otel"
    "go.opentelemetry.io/otel/attribute"
    "go.opentelemetry.io/otel/trace"
)

// gRPC Server
func runServer() {
    lis, err := net.Listen("tcp", ":50051")
    if err != nil {
        log.Fatalf("failed to listen: %v", err)
    }

    // åˆ›å»º gRPC Server å¹¶æ·»åŠ æ‹¦æˆªå™¨
    s := grpc.NewServer(
        grpc.StatsHandler(otelgrpc.NewServerHandler(
            otelgrpc.WithTracerProvider(otel.GetTracerProvider()),
            otelgrpc.WithMessageEvents(otelgrpc.ReceivedEvents, otelgrpc.SentEvents),
        )),
    )

    // æ³¨å†ŒæœåŠ¡
    // pb.RegisterGreeterServer(s, &server{})

    if err := s.Serve(lis); err != nil {
        log.Fatalf("failed to serve: %v", err)
    }
}

// gRPC Client
func createClient(ctx context.Context) (*grpc.ClientConn, error) {
    return grpc.NewClient("localhost:50051",
        grpc.WithTransportCredentials(insecure.NewCredentials()),
        grpc.WithStatsHandler(otelgrpc.NewClientHandler(
            otelgrpc.WithTracerProvider(otel.GetTracerProvider()),
        )),
    )
}

// æœåŠ¡å®ç°ç¤ºä¾‹
type server struct {
    // pb.UnimplementedGreeterServer
}

func (s *server) SayHello(ctx context.Context, in *pb.HelloRequest) (*pb.HelloReply, error) {
    // è·å– Span
    span := trace.SpanFromContext(ctx)
    span.SetAttributes(attribute.String("request.name", in.GetName()))

    // åˆ›å»ºå­ Span
    tracer := otel.Tracer("greeter-service")
    ctx, childSpan := tracer.Start(ctx, "process-greeting")
    defer childSpan.End()

    // ä¸šåŠ¡é€»è¾‘
    return &pb.HelloReply{Message: "Hello " + in.GetName()}, nil
}
```

**gRPC è¿½è¸ªç‰¹ç‚¹**:

```text
âœ… è‡ªåŠ¨åŒå‘è¿½è¸ª (Client + Server)
âœ… æµå¼ RPC æ”¯æŒ (Stream Tracing)
âœ… Metadata ä¼ æ’­ (è‡ªåŠ¨æ³¨å…¥/æå–)
âœ… é”™è¯¯ç æ˜ å°„ (gRPC Status â†’ Span Status)
âœ… æ€§èƒ½å¼€é”€: < 3%
```

---

## æ•°æ®åº“è¿½è¸ª

### é€šç”¨ database/sql è¿½è¸ª

```go
require (
    go.opentelemetry.io/contrib/instrumentation/database/sql/otelsql v0.58.0
)
```

**ä½¿ç”¨ç¤ºä¾‹**:

```go
package main

import (
    "context"
    "database/sql"

    "go.opentelemetry.io/contrib/instrumentation/database/sql/otelsql"
    _ "github.com/go-sql-driver/mysql" // MySQL driver
)

func initDB() (*sql.DB, error) {
    // æ³¨å†Œå¸¦è¿½è¸ªçš„ Driver
    driverName, err := otelsql.Register("mysql",
        otelsql.WithAttributes(
            attribute.String("db.system", "mysql"),
        ),
        otelsql.WithSpanOptions(otelsql.SpanOptions{
            OmitRows:                 false,
            OmitConnectorConnect:     false,
            OmitConnResetSession:     true,
            OmitConnPrepare:          false,
            OmitConnQuery:            false,
            OmitStmtClose:            true,
        }),
    )
    if err != nil {
        return nil, err
    }

    // ä½¿ç”¨è¿½è¸ª Driver
    db, err := sql.Open(driverName, "user:password@tcp(localhost:3306)/dbname")
    if err != nil {
        return nil, err
    }

    // é…ç½®è¿æ¥æ± 
    db.SetMaxOpenConns(25)
    db.SetMaxIdleConns(5)
    db.SetConnMaxLifetime(5 * time.Minute)

    // è®°å½•æ•°æ®åº“ç»Ÿè®¡åˆ° Metrics
    if err := otelsql.RecordStats(db); err != nil {
        return nil, err
    }

    return db, nil
}

func queryUser(ctx context.Context, db *sql.DB, userID int) error {
    // Query ä¼šè‡ªåŠ¨åˆ›å»º Span
    row := db.QueryRowContext(ctx, "SELECT name, email FROM users WHERE id = ?", userID)
    
    var name, email string
    if err := row.Scan(&name, &email); err != nil {
        return err
    }

    // Span ä¼šè‡ªåŠ¨åŒ…å«:
    // - db.statement: SELECT name, email FROM users WHERE id = ?
    // - db.system: mysql
    // - db.rows_affected: 1

    return nil
}
```

**æ”¯æŒçš„æ•°æ®åº“é©±åŠ¨**:

| æ•°æ®åº“ | Driver | åŒ…å | æˆç†Ÿåº¦ |
|--------|--------|------|--------|
| PostgreSQL | pgx/v5 | github.com/jackc/pgx/v5 | â­â­â­â­â­ |
| MySQL | go-sql-driver | github.com/go-sql-driver/mysql | â­â­â­â­â­ |
| SQLite | mattn/go-sqlite3 | github.com/mattn/go-sqlite3 | â­â­â­â­ |
| SQL Server | go-mssqldb | github.com/microsoft/go-mssqldb | â­â­â­â­ |
| Oracle | godror | github.com/godror/godror | â­â­â­ |

### GORM v2 é›†æˆ (æœ€æµè¡Œ ORM)

```go
require (
    gorm.io/gorm v1.25.12
    gorm.io/driver/mysql v1.5.7
    go.opentelemetry.io/contrib/instrumentation/github.com/gorm/gorm/otelgorm v0.58.0
)
```

**å®Œæ•´ç¤ºä¾‹**:

```go
package main

import (
    "context"

    "gorm.io/gorm"
    "gorm.io/driver/mysql"
    "go.opentelemetry.io/contrib/instrumentation/gorm.io/gorm/otelgorm"
)

type User struct {
    ID    uint
    Name  string
    Email string
}

func initGORM() (*gorm.DB, error) {
    dsn := "user:password@tcp(127.0.0.1:3306)/dbname?charset=utf8mb4&parseTime=True"
    db, err := gorm.Open(mysql.Open(dsn), &gorm.Config{})
    if err != nil {
        return nil, err
    }

    // ä½¿ç”¨ OpenTelemetry æ’ä»¶
    if err := db.Use(otelgorm.NewPlugin(
        otelgorm.WithTracerProvider(otel.GetTracerProvider()),
        otelgorm.WithDBName("mydb"),
        otelgorm.WithAttributes(
            attribute.String("db.system", "mysql"),
        ),
    )); err != nil {
        return nil, err
    }

    return db, nil
}

func createUser(ctx context.Context, db *gorm.DB) error {
    // ä¼ å…¥ Context,è‡ªåŠ¨è¿½è¸ª
    user := User{Name: "John", Email: "john@example.com"}
    
    // åˆ›å»ºæ“ä½œä¼šç”Ÿæˆ Span: gorm.create
    result := db.WithContext(ctx).Create(&user)
    return result.Error
}

func queryUsers(ctx context.Context, db *gorm.DB) ([]User, error) {
    var users []User
    
    // æŸ¥è¯¢æ“ä½œä¼šç”Ÿæˆ Span: gorm.query
    result := db.WithContext(ctx).
        Where("email LIKE ?", "%@example.com").
        Limit(10).
        Find(&users)
    
    return users, result.Error
}

func updateUser(ctx context.Context, db *gorm.DB, userID uint) error {
    // æ›´æ–°æ“ä½œä¼šç”Ÿæˆ Span: gorm.update
    result := db.WithContext(ctx).
        Model(&User{}).
        Where("id = ?", userID).
        Update("email", "newemail@example.com")
    
    return result.Error
}
```

**GORM è¿½è¸ªç‰¹ç‚¹**:

```text
âœ… æ‰€æœ‰ CRUD æ“ä½œè‡ªåŠ¨è¿½è¸ª
âœ… åŸç”Ÿ SQL è¯­å¥è®°å½•
âœ… æ‰§è¡Œæ—¶é—´å’Œè¡Œæ•°ç»Ÿè®¡
âœ… å…³è”æŸ¥è¯¢å®Œæ•´è¿½è¸ª
âœ… æ‰¹é‡æ“ä½œä¼˜åŒ–
âœ… æ€§èƒ½å¼€é”€: ~5%
```

### Ent ORM (Facebook/Meta)

```go
require (
    entgo.io/ent v0.14.1
    go.opentelemetry.io/contrib/instrumentation/entgo.io/ent/otelent v0.58.0
)
```

**ä½¿ç”¨ç¤ºä¾‹**:

```go
package main

import (
    "context"

    "entgo.io/ent/dialect"
    "entgo.io/ent/dialect/sql"
    "go.opentelemetry.io/contrib/instrumentation/entgo.io/ent/otelent"
    _ "github.com/go-sql-driver/mysql"
)

func initEnt() (*ent.Client, error) {
    // æ‰“å¼€æ•°æ®åº“è¿æ¥
    drv, err := sql.Open(dialect.MySQL, "user:pass@tcp(localhost)/dbname")
    if err != nil {
        return nil, err
    }

    // æ·»åŠ  OpenTelemetry Hook
    client := ent.NewClient(
        ent.Driver(drv),
        ent.Driver(otelent.NewDriver(drv,
            otelent.WithTracerProvider(otel.GetTracerProvider()),
            otelent.WithSpanOptions(trace.WithAttributes(
                attribute.String("db.system", "mysql"),
            )),
        )),
    )

    return client, nil
}

func createPost(ctx context.Context, client *ent.Client) error {
    // æ‰€æœ‰ Ent æ“ä½œè‡ªåŠ¨è¿½è¸ª
    post, err := client.Post.
        Create().
        SetTitle("Hello World").
        SetBody("This is my first post").
        Save(ctx)
    
    return err
}
```

### Redis è¿½è¸ª

```go
require (
    github.com/redis/go-redis/v9 v9.7.0
    go.opentelemetry.io/contrib/instrumentation/github.com/redis/go-redis/v9/otelredis v0.58.0
)
```

**å®Œæ•´ç¤ºä¾‹**:

```go
package main

import (
    "context"
    "time"

    "github.com/redis/go-redis/v9"
    "go.opentelemetry.io/contrib/instrumentation/github.com/redis/go-redis/v9/otelredis"
)

func initRedis() *redis.Client {
    rdb := redis.NewClient(&redis.Options{
        Addr:         "localhost:6379",
        Password:     "",
        DB:           0,
        DialTimeout:  5 * time.Second,
        ReadTimeout:  3 * time.Second,
        WriteTimeout: 3 * time.Second,
        PoolSize:     10,
    })

    // æ·»åŠ  OpenTelemetry Hook
    if err := otelredis.InstrumentTracing(rdb,
        otelredis.WithTracerProvider(otel.GetTracerProvider()),
        otelredis.WithAttributes(
            attribute.String("db.system", "redis"),
            attribute.String("db.redis.database_index", "0"),
        ),
    ); err != nil {
        panic(err)
    }

    // æ·»åŠ  Metrics
    if err := otelredis.InstrumentMetrics(rdb); err != nil {
        panic(err)
    }

    return rdb
}

func cacheUser(ctx context.Context, rdb *redis.Client) error {
    // æ‰€æœ‰ Redis å‘½ä»¤è‡ªåŠ¨è¿½è¸ª
    err := rdb.Set(ctx, "user:123", `{"name":"John"}`, 10*time.Minute).Err()
    if err != nil {
        return err
    }

    // GET å‘½ä»¤ä¹Ÿä¼šè¢«è¿½è¸ª
    val, err := rdb.Get(ctx, "user:123").Result()
    if err != nil {
        return err
    }

    // Pipeline æ“ä½œ
    pipe := rdb.Pipeline()
    pipe.Set(ctx, "key1", "value1", 0)
    pipe.Set(ctx, "key2", "value2", 0)
    _, err = pipe.Exec(ctx) // æ•´ä¸ª Pipeline ä½œä¸ºä¸€ä¸ª Span

    return err
}
```

**Redis è¿½è¸ªç‰¹ç‚¹**:

```text
âœ… æ‰€æœ‰å‘½ä»¤è‡ªåŠ¨è¿½è¸ª (åŒ…æ‹¬ Pipeline)
âœ… å‘½ä»¤å‚æ•°å®‰å…¨è®°å½• (æ•æ„Ÿæ•°æ®è„±æ•)
âœ… è¿æ¥æ± ç»Ÿè®¡
âœ… æ…¢æŸ¥è¯¢è¯†åˆ«
âœ… æ€§èƒ½å¼€é”€: < 2%
```

---

## æ¶ˆæ¯é˜Ÿåˆ—è¿½è¸ª

### Kafka é›†æˆ

```go
require (
    github.com/IBM/sarama v1.44.0
    go.opentelemetry.io/contrib/instrumentation/github.com/IBM/sarama/otelsarama v0.58.0
)
```

**Producer ç¤ºä¾‹**:

```go
package main

import (
    "context"

    "github.com/IBM/sarama"
    "go.opentelemetry.io/contrib/instrumentation/github.com/IBM/sarama/otelsarama"
)

func initKafkaProducer() (sarama.SyncProducer, error) {
    config := sarama.NewConfig()
    config.Producer.Return.Successes = true
    config.Producer.RequiredAcks = sarama.WaitForAll

    brokers := []string{"localhost:9092"}
    producer, err := sarama.NewSyncProducer(brokers, config)
    if err != nil {
        return nil, err
    }

    // åŒ…è£… Producer æ·»åŠ è¿½è¸ª
    return otelsarama.WrapSyncProducer(config, producer), nil
}

func sendMessage(ctx context.Context, producer sarama.SyncProducer) error {
    message := &sarama.ProducerMessage{
        Topic: "user-events",
        Value: sarama.StringEncoder("user created"),
        Headers: []sarama.RecordHeader{
            {Key: []byte("event_type"), Value: []byte("user.created")},
        },
    }

    // å‘é€æ¶ˆæ¯ä¼šè‡ªåŠ¨åˆ›å»º Span
    // å¹¶æ³¨å…¥ TraceContext åˆ° Kafka Headers
    partition, offset, err := producer.SendMessage(message)
    
    return err
}
```

**Consumer ç¤ºä¾‹**:

```go
package main

import (
    "context"

    "github.com/IBM/sarama"
    "go.opentelemetry.io/contrib/instrumentation/github.com/IBM/sarama/otelsarama"
)

type ConsumerHandler struct{}

func (h *ConsumerHandler) Setup(sarama.ConsumerGroupSession) error   { return nil }
func (h *ConsumerHandler) Cleanup(sarama.ConsumerGroupSession) error { return nil }

func (h *ConsumerHandler) ConsumeClaim(session sarama.ConsumerGroupSession, claim sarama.ConsumerGroupClaim) error {
    for message := range claim.Messages() {
        // ä» Kafka Headers æå– TraceContext
        ctx := otelsarama.ExtractProducerMessageContext(context.Background(), message)
        
        // å¤„ç†æ¶ˆæ¯ (åœ¨è¿½è¸ªä¸Šä¸‹æ–‡ä¸­)
        tracer := otel.Tracer("kafka-consumer")
        ctx, span := tracer.Start(ctx, "process-message")
        
        // ä¸šåŠ¡é€»è¾‘
        processMessage(ctx, message)
        
        span.End()
        session.MarkMessage(message, "")
    }
    return nil
}

func initKafkaConsumer() error {
    config := sarama.NewConfig()
    config.Consumer.Return.Errors = true

    brokers := []string{"localhost:9092"}
    group := "my-consumer-group"

    // åˆ›å»º Consumer Group
    client, err := sarama.NewConsumerGroup(brokers, group, config)
    if err != nil {
        return err
    }

    // åŒ…è£… Consumer æ·»åŠ è¿½è¸ª
    handler := otelsarama.WrapConsumerGroupHandler(&ConsumerHandler{})

    // å¼€å§‹æ¶ˆè´¹
    ctx := context.Background()
    topics := []string{"user-events"}
    
    go func() {
        for {
            if err := client.Consume(ctx, topics, handler); err != nil {
                log.Printf("Error from consumer: %v", err)
            }
        }
    }()

    return nil
}
```

**Kafka è¿½è¸ªç‰¹ç‚¹**:

```text
âœ… Producer å’Œ Consumer å®Œæ•´é“¾è·¯è¿½è¸ª
âœ… TraceContext é€šè¿‡ Kafka Headers ä¼ æ’­
âœ… æ¶ˆæ¯å»¶è¿Ÿç»Ÿè®¡ (å‘é€æ—¶é—´ â†’ æ¶ˆè´¹æ—¶é—´)
âœ… æ‰¹é‡å‘é€ä¼˜åŒ–
âœ… æ€§èƒ½å¼€é”€: ~3%
```

### NATS é›†æˆ

```go
require (
    github.com/nats-io/nats.go v1.38.0
    go.opentelemetry.io/contrib/instrumentation/github.com/nats-io/nats.go/otel nats v0.58.0
)
```

**ä½¿ç”¨ç¤ºä¾‹**:

```go
package main

import (
    "context"

    "github.com/nats-io/nats.go"
    otelna "go.opentelemetry.io/contrib/instrumentation/github.com/nats-io/nats.go/otel nats"
)

func initNATS() (*nats.Conn, error) {
    // è¿æ¥ NATS
    nc, err := nats.Connect("nats://localhost:4222",
        nats.Name("my-service"),
    )
    if err != nil {
        return nil, err
    }

    return nc, nil
}

func publishMessage(ctx context.Context, nc *nats.Conn) error {
    // åˆ›å»ºå¸¦è¿½è¸ªçš„ Publisher
    publisher := otelnats.NewPublisher(nc,
        otelnats.WithTracerProvider(otel.GetTracerProvider()),
    )

    // å‘é€æ¶ˆæ¯ (è‡ªåŠ¨æ³¨å…¥ TraceContext)
    return publisher.Publish(ctx, "user.events", []byte("user created"))
}

func subscribeMessages(ctx context.Context, nc *nats.Conn) error {
    // åˆ›å»ºå¸¦è¿½è¸ªçš„ Subscriber
    subscriber := otelnats.NewSubscriber(nc,
        otelnats.WithTracerProvider(otel.GetTracerProvider()),
    )

    // è®¢é˜…æ¶ˆæ¯ (è‡ªåŠ¨æå– TraceContext)
    _, err := subscriber.Subscribe("user.events", func(msg *nats.Msg) {
        // msg.Context() å·²åŒ…å«è¿½è¸ªä¸Šä¸‹æ–‡
        ctx := msg.Context()
        
        tracer := otel.Tracer("nats-consumer")
        ctx, span := tracer.Start(ctx, "process-nats-message")
        defer span.End()

        // å¤„ç†æ¶ˆæ¯
        processNATSMessage(ctx, msg.Data)
    })

    return err
}
```

---

## ç¼“å­˜è¿½è¸ª

### Memcached

```go
require (
    github.com/bradfitz/gomemcache v0.0.0-20230905024940-24af94b03874
    go.opentelemetry.io/contrib/instrumentation/github.com/bradfitz/gomemcache/memcache/otelmemcache v0.58.0
)
```

**ä½¿ç”¨ç¤ºä¾‹**:

```go
package main

import (
    "context"

    "github.com/bradfitz/gomemcache/memcache"
    "go.opentelemetry.io/contrib/instrumentation/github.com/bradfitz/gomemcache/memcache/otelmemcache"
)

func initMemcached() *memcache.Client {
    mc := memcache.New("localhost:11211")
    
    // åŒ…è£… Client æ·»åŠ è¿½è¸ª
    return otelmemcache.NewClientWithTracing(mc,
        otelmemcache.WithTracerProvider(otel.GetTracerProvider()),
        otelmemcache.WithAttributes(
            attribute.String("db.system", "memcached"),
        ),
    )
}

func cacheData(ctx context.Context, mc *memcache.Client) error {
    // Set æ“ä½œè‡ªåŠ¨è¿½è¸ª
    err := mc.Set(&memcache.Item{
        Key:        "user:123",
        Value:      []byte("John Doe"),
        Expiration: 3600,
    })
    if err != nil {
        return err
    }

    // Get æ“ä½œè‡ªåŠ¨è¿½è¸ª
    item, err := mc.Get("user:123")
    return err
}
```

---

## äº‘å¹³å° SDK é›†æˆ

### AWS SDK v2

```go
require (
    github.com/aws/aws-sdk-go-v2 v1.32.7
    github.com/aws/aws-sdk-go-v2/config v1.28.7
    go.opentelemetry.io/contrib/instrumentation/github.com/aws/aws-sdk-go-v2/otelaws v0.58.0
)
```

**ä½¿ç”¨ç¤ºä¾‹**:

```go
package main

import (
    "context"

    "github.com/aws/aws-sdk-go-v2/aws"
    "github.com/aws/aws-sdk-go-v2/config"
    "github.com/aws/aws-sdk-go-v2/service/s3"
    "go.opentelemetry.io/contrib/instrumentation/github.com/aws/aws-sdk-go-v2/otelaws"
)

func initAWSConfig(ctx context.Context) (aws.Config, error) {
    // åŠ è½½ AWS é…ç½®
    cfg, err := config.LoadDefaultConfig(ctx,
        config.WithRegion("us-east-1"),
    )
    if err != nil {
        return aws.Config{}, err
    }

    // æ·»åŠ  OpenTelemetry ä¸­é—´ä»¶
    otelaws.AppendMiddlewares(&cfg.APIOptions,
        otelaws.WithTracerProvider(otel.GetTracerProvider()),
        otelaws.WithAttributeSetter(otelaws.DefaultAttributeSetter),
    )

    return cfg, nil
}

func uploadToS3(ctx context.Context, cfg aws.Config) error {
    // åˆ›å»º S3 Client (å·²åŒ…å«è¿½è¸ª)
    client := s3.NewFromConfig(cfg)

    // ä¸Šä¼ æ–‡ä»¶ (è‡ªåŠ¨åˆ›å»º Span)
    _, err := client.PutObject(ctx, &s3.PutObjectInput{
        Bucket: aws.String("my-bucket"),
        Key:    aws.String("test.txt"),
        Body:   strings.NewReader("Hello World"),
    })

    return err
}
```

**æ”¯æŒçš„ AWS æœåŠ¡**:

```text
âœ… S3 - å¯¹è±¡å­˜å‚¨
âœ… DynamoDB - NoSQL æ•°æ®åº“
âœ… SQS - æ¶ˆæ¯é˜Ÿåˆ—
âœ… SNS - é€šçŸ¥æœåŠ¡
âœ… Lambda - å‡½æ•°è°ƒç”¨
âœ… EC2 - å®ä¾‹ç®¡ç†
âœ… æ‰€æœ‰ AWS SDK v2 æœåŠ¡
```

### Google Cloud SDK

```go
require (
    cloud.google.com/go v0.117.0
    go.opentelemetry.io/contrib/instrumentation/google.golang.org/cloud/otelcloud v0.58.0
)
```

### Azure SDK

```go
require (
    github.com/Azure/azure-sdk-for-go/sdk/azcore v1.16.0
    go.opentelemetry.io/contrib/instrumentation/github.com/Azure/azure-sdk-for-go/azcore/otelazcore v0.58.0
)
```

---

## æµ‹è¯•ä¸å¼€å‘å·¥å…·

### æµ‹è¯•å·¥å…·

```go
require (
    // æµ‹è¯•æ¡†æ¶
    github.com/stretchr/testify v1.10.0
    
    // è¿½è¸ªæµ‹è¯•å·¥å…·
    go.opentelemetry.io/otel/sdk/trace/tracetest v1.32.0
    
    // Mock Exporter
    go.opentelemetry.io/otel/exporters/stdout/stdouttrace v1.32.0
)
```

**æµ‹è¯•ç¤ºä¾‹**:

```go
package main_test

import (
    "context"
    "testing"

    "github.com/stretchr/testify/assert"
    "go.opentelemetry.io/otel"
    "go.opentelemetry.io/otel/sdk/trace"
    "go.opentelemetry.io/otel/sdk/trace/tracetest"
)

func TestTracedFunction(t *testing.T) {
    // åˆ›å»º InMemory Exporter
    exporter := tracetest.NewInMemoryExporter()
    
    // åˆ›å»º TracerProvider
    tp := trace.NewTracerProvider(
        trace.WithBatcher(exporter),
        trace.WithSampler(trace.AlwaysSample()),
    )
    defer tp.Shutdown(context.Background())
    
    otel.SetTracerProvider(tp)

    // æ‰§è¡Œè¢«æµ‹è¯•å‡½æ•°
    ctx := context.Background()
    tracer := otel.Tracer("test")
    ctx, span := tracer.Start(ctx, "test-operation")
    
    // æ¨¡æ‹Ÿä¸šåŠ¡é€»è¾‘
    doSomething(ctx)
    
    span.End()

    // éªŒè¯ Span
    spans := exporter.GetSpans()
    assert.Len(t, spans, 1)
    assert.Equal(t, "test-operation", spans[0].Name)
}
```

### æ€§èƒ½åˆ†æå·¥å…·

```go
require (
    // pprof HTTP æœåŠ¡å™¨
    net/http/pprof // æ ‡å‡†åº“

    // æ€§èƒ½åˆ†æ
    github.com/google/pprof v0.0.0-20250108182939-0984d5582063
    
    // å†…å­˜æ³„æ¼æ£€æµ‹
    go.uber.org/goleak v1.3.0
)
```

---

## æ€§èƒ½å¯¹æ¯”ä¸é€‰å‹

### Exporter é€‰å‹

| Exporter | ååé‡ | å»¶è¿Ÿ | CPU | å†…å­˜ | æ¨èåœºæ™¯ |
|----------|--------|------|-----|------|---------|
| OTLP gRPC | â­â­â­â­â­ | â­â­â­â­â­ | ä½ | ä¸­ | ç”Ÿäº§ç¯å¢ƒ |
| OTLP HTTP | â­â­â­â­ | â­â­â­â­ | ä¸­ | ä¸­ | é˜²ç«å¢™é™åˆ¶ |
| Jaeger | â­â­â­ | â­â­â­ | ä¸­ | é«˜ | å·²åºŸå¼ƒ |
| Stdout | â­â­â­â­â­ | â­â­â­â­â­ | ä½ | ä½ | æœ¬åœ°å¼€å‘ |

### HTTP æ¡†æ¶é€‰å‹

**é€‰å‹å»ºè®®**:

```text
ğŸŸ¢ æ–°é¡¹ç›®: 
   - è¿½æ±‚æ€§èƒ½ â†’ Fiber
   - RESTful API â†’ Gin
   - æ ‡å‡†åº“é£æ ¼ â†’ Chi

ğŸŸ¡ ç°æœ‰é¡¹ç›®:
   - å·²ç”¨ net/http â†’ æ·»åŠ  otelhttp
   - å·²ç”¨ Echo â†’ æ·»åŠ  otelecho
   - å·²ç”¨ Gin â†’ æ·»åŠ  otelgin

ğŸ”´ é¿å…:
   - è¿‡æ—¶æ¡†æ¶ (Martini, Revel)
   - æ— ä¸­é—´ä»¶æ”¯æŒçš„æ¡†æ¶
```

---

## å…¼å®¹æ€§çŸ©é˜µ

### Go ç‰ˆæœ¬å…¼å®¹æ€§

| OpenTelemetry ç‰ˆæœ¬ | æœ€ä½ Go ç‰ˆæœ¬ | æ¨è Go ç‰ˆæœ¬ | æœ€é«˜ Go ç‰ˆæœ¬ |
|-------------------|-------------|-------------|-------------|
| v1.32.0 | 1.22 | 1.25.1 | 1.25.x |
| v1.31.0 | 1.22 | 1.24 | 1.24.x |
| v1.30.0 | 1.21 | 1.23 | 1.23.x |

### ä¾èµ–åº“å…¼å®¹æ€§

```go
// æ¨èçš„å®Œæ•´ go.mod (Go 1.25.1)
module myapp

go 1.25.1

require (
    // OpenTelemetry Core
    go.opentelemetry.io/otel v1.32.0
    go.opentelemetry.io/otel/sdk v1.32.0
    go.opentelemetry.io/otel/metric v1.32.0
    go.opentelemetry.io/otel/sdk/metric v1.32.0
    
    // Exporters
    go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracegrpc v1.32.0
    go.opentelemetry.io/otel/exporters/otlp/otlpmetric/otlpmetricgrpc v1.32.0
    go.opentelemetry.io/otel/exporters/stdout/stdouttrace v1.32.0
    
    // Instrumentation
    go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp v0.58.0
    go.opentelemetry.io/contrib/instrumentation/google.golang.org/grpc/otelgrpc v0.58.0
    go.opentelemetry.io/contrib/instrumentation/database/sql/otelsql v0.58.0
    
    // Web Frameworks
    github.com/gin-gonic/gin v1.10.0
    go.opentelemetry.io/contrib/instrumentation/github.com/gin-gonic/gin/otelgin v0.58.0
    
    // Database
    gorm.io/gorm v1.25.12
    go.opentelemetry.io/contrib/instrumentation/gorm.io/gorm/otelgorm v0.58.0
    
    // gRPC
    google.golang.org/grpc v1.68.1
    
    // Semantic Conventions
    go.opentelemetry.io/otel/semconv/v1.27.0 v1.27.0
)
```

---

## ä¾èµ–ç®¡ç†æœ€ä½³å®è·µ

### 1. ä½¿ç”¨ Go Modules

```bash
# åˆå§‹åŒ–æ¨¡å—
go mod init myapp

# æ·»åŠ ä¾èµ–
go get go.opentelemetry.io/otel@latest

# æ•´ç†ä¾èµ–
go mod tidy

# éªŒè¯ä¾èµ–
go mod verify

# æŸ¥çœ‹ä¾èµ–æ ‘
go mod graph
```

### 2. å›ºå®šç‰ˆæœ¬ (ç”Ÿäº§ç¯å¢ƒ)

```go
// go.mod - ä½¿ç”¨ç²¾ç¡®ç‰ˆæœ¬
require (
    go.opentelemetry.io/otel v1.32.0 // ä¸è¦ç”¨ @latest
)
```

### 3. ä¾èµ–æ›´æ–°ç­–ç•¥

```bash
# æŸ¥çœ‹å¯æ›´æ–°çš„ä¾èµ–
go list -u -m all

# æ›´æ–°ç‰¹å®šä¾èµ–
go get -u go.opentelemetry.io/otel

# æ›´æ–°æ‰€æœ‰ä¾èµ– (è°¨æ…)
go get -u ./...
```

### 4. ä½¿ç”¨ Dependabot (GitHub)

```yaml
# .github/dependabot.yml
version: 2
updates:
  - package-ecosystem: "gomod"
    directory: "/"
    schedule:
      interval: "weekly"
    open-pull-requests-limit: 10
```

### 5. Vendor æ¨¡å¼ (å¯é€‰)

```bash
# åˆ›å»º vendor ç›®å½•
go mod vendor

# ä½¿ç”¨ vendor æ„å»º
go build -mod=vendor
```

---

## æ€»ç»“

**å…³é”®è¦ç‚¹**:

```text
âœ… ä½¿ç”¨ OpenTelemetry v1.32.0+ (ç¨³å®šç‰ˆ)
âœ… ä¼˜å…ˆé€‰æ‹© OTLP gRPC Exporter
âœ… æ ¹æ®æ¡†æ¶é€‰æ‹©å¯¹åº”çš„ contrib åº“
âœ… æ•°æ®åº“ä½¿ç”¨ otelsql æˆ– ORM é›†æˆ
âœ… æ¶ˆæ¯é˜Ÿåˆ—ä½¿ç”¨å®˜æ–¹ instrumentation
âœ… å›ºå®šä¾èµ–ç‰ˆæœ¬ (ç”Ÿäº§ç¯å¢ƒ)
âœ… å®šæœŸæ›´æ–° (æ¯æœˆæ£€æŸ¥)
âœ… æ€§èƒ½æµ‹è¯• (å¼€é”€ < 5%)
```

**å¿«é€Ÿæ£€æŸ¥æ¸…å•**:

```bash
âœ… go.mod ä½¿ç”¨ Go 1.25.1
âœ… OpenTelemetry SDK v1.32.0
âœ… æ‰€æœ‰ contrib åº“ v0.58.0
âœ… gRPC v1.68.1+
âœ… ä¾èµ–å®šæœŸæ›´æ–°
âœ… æ— å®‰å…¨æ¼æ´ (go list -m -json all | nancy sleuth)
âœ… æ€§èƒ½æµ‹è¯•é€šè¿‡
```

---

**ç›¸å…³æ–‡æ¡£**:

- [Go 1.25.1 å®Œæ•´é›†æˆæŒ‡å—](./01_Go_1.25.1_å®Œæ•´é›†æˆæŒ‡å—.md)
- [Go SDK æ·±åº¦å®è·µ](./05_Go_SDKæ·±åº¦å®è·µä¸ä¸­é—´ä»¶é›†æˆ.md)
- [Go æ€§èƒ½ä¼˜åŒ–](./03_Goæ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ.md)
