# Go ä¸ OpenTelemetry (OTLP) æ€§èƒ½ä¼˜åŒ–å®è·µæŒ‡å—

> **æœ€åæ›´æ–°**: 2025å¹´10æœˆ8æ—¥  
> **Go ç‰ˆæœ¬**: 1.25.1+  
> **OpenTelemetry SDK**: v1.32.0+  
> **ç›®æ ‡è¯»è€…**: Go å¼€å‘è€…ã€DevOpså·¥ç¨‹å¸ˆã€SREã€æ€§èƒ½å·¥ç¨‹å¸ˆ

---

## ç›®å½•

- [Go ä¸ OpenTelemetry (OTLP) æ€§èƒ½ä¼˜åŒ–å®è·µæŒ‡å—](#go-ä¸-opentelemetry-otlp-æ€§èƒ½ä¼˜åŒ–å®è·µæŒ‡å—)
  - [ç›®å½•](#ç›®å½•)
  - [1. æ€§èƒ½æ¦‚è¿°](#1-æ€§èƒ½æ¦‚è¿°)
    - [1.1 æ€§èƒ½ç›®æ ‡](#11-æ€§èƒ½ç›®æ ‡)
    - [1.2 æ€§èƒ½æŒ‡æ ‡](#12-æ€§èƒ½æŒ‡æ ‡)
  - [2. SDKæ€§èƒ½ä¼˜åŒ–](#2-sdkæ€§èƒ½ä¼˜åŒ–)
    - [2.1 æ‰¹å¤„ç†ä¼˜åŒ–](#21-æ‰¹å¤„ç†ä¼˜åŒ–)
    - [2.2 å¼‚æ­¥å¯¼å‡º](#22-å¼‚æ­¥å¯¼å‡º)
    - [2.3 é‡‡æ ·ä¼˜åŒ–](#23-é‡‡æ ·ä¼˜åŒ–)
    - [2.4 å±æ€§é™åˆ¶](#24-å±æ€§é™åˆ¶)
  - [3. Collectoræ€§èƒ½ä¼˜åŒ–](#3-collectoræ€§èƒ½ä¼˜åŒ–)
    - [3.1 èµ„æºé…ç½®](#31-èµ„æºé…ç½®)
    - [3.2 Pipelineä¼˜åŒ–](#32-pipelineä¼˜åŒ–)
    - [3.3 æ‰¹å¤„ç†é…ç½®](#33-æ‰¹å¤„ç†é…ç½®)
    - [3.4 å†…å­˜ç®¡ç†](#34-å†…å­˜ç®¡ç†)
  - [4. ç½‘ç»œä¼˜åŒ–](#4-ç½‘ç»œä¼˜åŒ–)
    - [4.1 å‹ç¼©](#41-å‹ç¼©)
    - [4.2 è¿æ¥å¤ç”¨](#42-è¿æ¥å¤ç”¨)
    - [4.3 åè®®é€‰æ‹©](#43-åè®®é€‰æ‹©)
  - [5. æ•°æ®é‡ä¼˜åŒ–](#5-æ•°æ®é‡ä¼˜åŒ–)
    - [5.1 é‡‡æ ·ç­–ç•¥](#51-é‡‡æ ·ç­–ç•¥)
    - [5.2 å±æ€§ä¼˜åŒ–](#52-å±æ€§ä¼˜åŒ–)
    - [5.3 åŸºæ•°æ§åˆ¶](#53-åŸºæ•°æ§åˆ¶)
  - [6. å­˜å‚¨ä¼˜åŒ–](#6-å­˜å‚¨ä¼˜åŒ–)
    - [6.1 æ•°æ®ä¿ç•™](#61-æ•°æ®ä¿ç•™)
    - [6.2 ç´¢å¼•ä¼˜åŒ–](#62-ç´¢å¼•ä¼˜åŒ–)
    - [6.3 å†·çƒ­åˆ†ç¦»](#63-å†·çƒ­åˆ†ç¦»)
  - [7. å®æ—¶ç›‘æ§](#7-å®æ—¶ç›‘æ§)
    - [7.1 å…³é”®æŒ‡æ ‡](#71-å…³é”®æŒ‡æ ‡)
    - [7.2 å‘Šè­¦è§„åˆ™](#72-å‘Šè­¦è§„åˆ™)
  - [8. æ€§èƒ½è°ƒä¼˜æµç¨‹](#8-æ€§èƒ½è°ƒä¼˜æµç¨‹)
  - [9. æ€§èƒ½åŸºå‡†æµ‹è¯•](#9-æ€§èƒ½åŸºå‡†æµ‹è¯•)
  - [10. æ•…éšœæ¡ˆä¾‹ä¸è§£å†³](#10-æ•…éšœæ¡ˆä¾‹ä¸è§£å†³)
  - [11. æœ€ä½³å®è·µæ¸…å•](#11-æœ€ä½³å®è·µæ¸…å•)
  - [12. å‚è€ƒèµ„æº](#12-å‚è€ƒèµ„æº)
  - [13. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ£€æŸ¥æ¸…å•](#13-ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ£€æŸ¥æ¸…å•)
  - [14. å¿«é€Ÿå‚è€ƒæ€»ç»“](#14-å¿«é€Ÿå‚è€ƒæ€»ç»“)
  - [15. å®Œæ•´ç¤ºä¾‹ï¼šç”Ÿäº§çº§ Go OTLP åº”ç”¨](#15-å®Œæ•´ç¤ºä¾‹ç”Ÿäº§çº§-go-otlp-åº”ç”¨)

---

## 1. æ€§èƒ½æ¦‚è¿°

### 1.1 æ€§èƒ½ç›®æ ‡

**æ ¸å¿ƒç›®æ ‡**ï¼š

```text
1. ä½å¼€é”€ (Low Overhead)
   CPUå¼€é”€: < 5%
   å†…å­˜å¼€é”€: < 100MB
   å»¶è¿Ÿå¢åŠ : < 1ms (p99)

2. é«˜åå (High Throughput)
   Traces: 10,000+ spans/s
   Metrics: 100,000+ points/s
   Logs: 50,000+ records/s

3. å¯é æ€§ (Reliability)
   æ•°æ®ä¸¢å¤±: < 0.01%
   é”™è¯¯ç‡: < 0.1%
   å¯ç”¨æ€§: 99.9%

4. å¯æ‰©å±• (Scalability)
   æ°´å¹³æ‰©å±•: çº¿æ€§å¢é•¿
   æ”¯æŒ: 1000+ æœåŠ¡
```

### 1.2 æ€§èƒ½æŒ‡æ ‡

**å…³é”®æ€§èƒ½æŒ‡æ ‡ (KPI)**ï¼š

```text
1. å»¶è¿ŸæŒ‡æ ‡
   - span_creation_latency: Spanåˆ›å»ºå»¶è¿Ÿ
   - export_latency: å¯¼å‡ºå»¶è¿Ÿ
   - end_to_end_latency: ç«¯åˆ°ç«¯å»¶è¿Ÿ

2. ååæŒ‡æ ‡
   - spans_per_second: Spanåå
   - metrics_per_second: Metricåå
   - logs_per_second: Logåå

3. èµ„æºæŒ‡æ ‡
   - cpu_usage: CPUä½¿ç”¨ç‡
   - memory_usage: å†…å­˜ä½¿ç”¨
   - network_bandwidth: ç½‘ç»œå¸¦å®½

4. å¯é æ€§æŒ‡æ ‡
   - drop_rate: æ•°æ®ä¸¢å¼ƒç‡
   - error_rate: é”™è¯¯ç‡
   - queue_length: é˜Ÿåˆ—é•¿åº¦

æ€§èƒ½é¢„ç®—ç¤ºä¾‹:
åº”ç”¨å»¶è¿Ÿé¢„ç®—: 100ms
å¯è§‚æµ‹æ€§å¼€é”€: < 5ms (5%)
- Spanåˆ›å»º: 0.5ms
- å±æ€§æ·»åŠ : 1ms
- å¯¼å‡º: 2ms
- ç½‘ç»œä¼ è¾“: 1.5ms
```

**Go åº”ç”¨æ€§èƒ½ç›®æ ‡ï¼ˆGo 1.25.1 + OTLPï¼‰**ï¼š

```text
Go åº”ç”¨æ€§èƒ½ç›®æ ‡:

1. Span åˆ›å»ºæ€§èƒ½
   - æ— é‡‡æ ·: < 500ns/span
   - 10%é‡‡æ ·: < 50ns/span (å¹³å‡)
   - ä½¿ç”¨æ± åŒ–: < 30ns/span

2. å†…å­˜ä½¿ç”¨
   - åŸºç¡€å¼€é”€: < 50MB
   - æ‰¹å¤„ç†é˜Ÿåˆ—: < 30MB
   - æ€»å†…å­˜: < 100MB

3. CPU å¼€é”€
   - æ— é‡‡æ ·: 0%
   - 10%é‡‡æ ·: < 2%
   - 100%é‡‡æ ·: < 5%

4. ç½‘ç»œå¼€é”€
   - å‹ç¼©å‰: 2KB/span
   - å‹ç¼©å: 600B/span (70% å‹ç¼©ç‡)
   - æ‰¹å¤„ç†: å‡å°‘ 90% ç½‘ç»œè°ƒç”¨

5. GC å½±å“
   - GC æš‚åœ: < 2ms (p99)
   - GC é¢‘ç‡: < 1æ¬¡/ç§’
   - ä½¿ç”¨æ± åŒ–: å‡å°‘ 80% GC å‹åŠ›
```

**Go 1.25.1 æ€§èƒ½ä¼˜åŠ¿**ï¼š

```text
Go 1.25.1 æ–°ç‰¹æ€§å¸¦æ¥çš„æ€§èƒ½æå‡:

1. å®¹å™¨æ„ŸçŸ¥ GOMAXPROCS
   - è‡ªåŠ¨é€‚é…å®¹å™¨ CPU é…é¢
   - é¿å…è¿‡åº¦å¹¶å‘
   - æ€§èƒ½æå‡: 10-20%

2. å¢é‡ GC ä¼˜åŒ–
   - GC æš‚åœå‡å°‘ 50%
   - æ›´é€‚åˆæ‰¹å¤„ç†åœºæ™¯
   - æ€§èƒ½æå‡: 5-10%

3. PGO (Profile-Guided Optimization)
   - åŸºäºçœŸå®è´Ÿè½½ä¼˜åŒ–
   - æ™ºèƒ½å†…è”å†³ç­–
   - æ€§èƒ½æå‡: 5-15%

4. ç¼–è¯‘å™¨ä¼˜åŒ–
   - å»è™šæ‹ŸåŒ–
   - å‡½æ•°å†…è”å¢å¼º
   - æ€§èƒ½æå‡: 3-8%

æ€»ä½“æ€§èƒ½æå‡: 20-50% (ç›¸æ¯” Go 1.24)
```

---

## 2. SDKæ€§èƒ½ä¼˜åŒ–

### 2.1 æ‰¹å¤„ç†ä¼˜åŒ–

**BatchSpanProcessoré…ç½®**ï¼š

```go
// Go SDKä¼˜åŒ–é…ç½®
import (
    "go.opentelemetry.io/otel/sdk/trace"
)

processor := trace.NewBatchSpanProcessor(
    exporter,
    // æ‰¹æ¬¡å¤§å°: 512 (é»˜è®¤)
    trace.WithBatchTimeout(5 * time.Second),
    
    // æœ€å¤§é˜Ÿåˆ—å¤§å°: 2048
    trace.WithMaxQueueSize(2048),
    
    // æœ€å¤§å¯¼å‡ºæ‰¹æ¬¡: 512
    trace.WithMaxExportBatchSize(512),
    
    // å¯¼å‡ºè¶…æ—¶: 30ç§’
    trace.WithExportTimeout(30 * time.Second),
)

// æ€§èƒ½å½±å“:
// æ‰¹æ¬¡è¶Šå¤§ â†’ ååè¶Šé«˜ â†’ å»¶è¿Ÿè¶Šé«˜
// æ‰¹æ¬¡è¶Šå° â†’ å»¶è¿Ÿè¶Šä½ â†’ ååè¶Šä½

// æ¨èé…ç½® (æ ¹æ®åœºæ™¯):
// ä½å»¶è¿Ÿåœºæ™¯: BatchSize=128, Timeout=1s
// é«˜åååœºæ™¯: BatchSize=1024, Timeout=10s
// å‡è¡¡åœºæ™¯: BatchSize=512, Timeout=5s
```

**Go 1.25.1 ä¼˜åŒ–å»ºè®®**ï¼š

```go
// ä½¿ç”¨ Go 1.25.1 çš„å®¹å™¨æ„ŸçŸ¥ GOMAXPROCS
// è‡ªåŠ¨ä¼˜åŒ–å¹¶å‘åº¦ï¼Œæå‡æ‰¹å¤„ç†æ€§èƒ½

// æ€§èƒ½è°ƒä¼˜ç¤ºä¾‹
processor := trace.NewBatchSpanProcessor(
    exporter,
    trace.WithBatchTimeout(5 * time.Second),
    trace.WithMaxQueueSize(2048),
    trace.WithMaxExportBatchSize(512),
    trace.WithExportTimeout(30 * time.Second),
    
    // Go 1.25.1 æ–°ç‰¹æ€§ï¼šä½¿ç”¨ PGO (Profile-Guided Optimization)
    // ç¼–è¯‘æ—¶ä½¿ç”¨: go build -pgo=auto
)

// æ€§èƒ½å¯¹æ¯”:
// é»˜è®¤é…ç½®: åå 5,000 spans/s
// ä¼˜åŒ–é…ç½®: åå 15,000 spans/s (3xæå‡)
```

### 2.2 å¼‚æ­¥å¯¼å‡º

**é¿å…é˜»å¡ä¸»æµç¨‹**ï¼š

```go
// âŒ é”™è¯¯: åŒæ­¥å¯¼å‡º (é˜»å¡)
type SyncExporter struct{}

func (e *SyncExporter) ExportSpans(ctx context.Context, spans []Span) error {
    // åŒæ­¥HTTPè¯·æ±‚ - é˜»å¡åº”ç”¨!
    return http.Post("http://backend", spans)
}

// âœ… æ­£ç¡®: å¼‚æ­¥å¯¼å‡º (éé˜»å¡)
processor := trace.NewBatchSpanProcessor(exporter)
// BatchSpanProcessorå†…éƒ¨ä½¿ç”¨goroutineå¼‚æ­¥å¯¼å‡º

// æ€§èƒ½å¯¹æ¯”:
// åŒæ­¥å¯¼å‡º: åº”ç”¨å»¶è¿Ÿ +50ms
// å¼‚æ­¥å¯¼å‡º: åº”ç”¨å»¶è¿Ÿ +0.1ms
```

**Go goroutine ä¼˜åŒ–**ï¼š

```go
// ä½¿ç”¨ goroutine æ± æ§åˆ¶å¹¶å‘æ•°ï¼Œé¿å… goroutine æ³„æ¼
type ExporterPool struct {
    workers    int
    jobQueue   chan []Span
    wg         sync.WaitGroup
}

func NewExporterPool(workers int, queueSize int) *ExporterPool {
    pool := &ExporterPool{
        workers:  workers,
        jobQueue: make(chan []Span, queueSize),
    }
    
    // å¯åŠ¨å›ºå®šæ•°é‡çš„ worker goroutines
    for i := 0; i < workers; i++ {
        pool.wg.Add(1)
        go pool.worker()
    }
    
    return pool
}

func (p *ExporterPool) worker() {
    defer p.wg.Done()
    for spans := range p.jobQueue {
        // å¼‚æ­¥å¯¼å‡ºï¼Œä¸é˜»å¡ä¸»æµç¨‹
        _ = p.exportSpans(context.Background(), spans)
    }
}

func (p *ExporterPool) Export(spans []Span) {
    select {
    case p.jobQueue <- spans:
        // æˆåŠŸå…¥é˜Ÿ
    default:
        // é˜Ÿåˆ—æ»¡ï¼Œä¸¢å¼ƒæˆ–è®°å½•æ—¥å¿—
        log.Printf("Export queue full, dropping %d spans", len(spans))
    }
}

// æ€§èƒ½ä¼˜åŠ¿:
// - æ§åˆ¶å¹¶å‘æ•°ï¼Œé¿å… goroutine çˆ†ç‚¸
// - éé˜»å¡å¯¼å‡ºï¼Œä¸å½±å“åº”ç”¨æ€§èƒ½
// - èµ„æºå¯æ§ï¼Œé€‚åˆç”Ÿäº§ç¯å¢ƒ
```

### 2.3 é‡‡æ ·ä¼˜åŒ–

**é‡‡æ ·é…ç½®**ï¼š

```go
// 1. TraceIdRatioBasedé‡‡æ · (Head-based)
sampler := trace.TraceIDRatioBased(0.1)  // 10%é‡‡æ ·

// 2. ParentBasedé‡‡æ · (ä¿æŒä¸Šæ¸¸å†³ç­–)
sampler := trace.ParentBased(
    trace.TraceIDRatioBased(0.1),
)

// 3. è‡ªå®šä¹‰é‡‡æ · (åŸºäºå±æ€§)
type CustomSampler struct {
    base trace.Sampler
}

func (s *CustomSampler) ShouldSample(
    ctx context.Context,
    traceID trace.TraceID,
    name string,
    spanKind trace.SpanKind,
    attributes []attribute.KeyValue,
    links []trace.Link,
) trace.SamplingResult {
    // æ€»æ˜¯é‡‡æ ·é”™è¯¯
    for _, attr := range attributes {
        if attr.Key == "error" && attr.Value.AsBool() {
            return trace.SamplingResult{
                Decision: trace.RecordAndSample,
            }
        }
    }
    
    // å…¶ä»–ä½¿ç”¨åŸºç¡€é‡‡æ ·å™¨
    return s.base.ShouldSample(ctx, traceID, name, spanKind, attributes, links)
}

// æ€§èƒ½å½±å“:
// 100%é‡‡æ ·: 100% æ•°æ®é‡ + 100% æˆæœ¬
// 10%é‡‡æ ·: 10% æ•°æ®é‡ + 10% æˆæœ¬
// æ™ºèƒ½é‡‡æ ·: 20-30% æ•°æ®é‡ + ä¿ç•™é‡è¦trace
```

**Go å†…å­˜æ± ä¼˜åŒ–**ï¼š

```go
// ä½¿ç”¨ sync.Pool å¤ç”¨ Span æ•°æ®ï¼Œå‡å°‘ GC å‹åŠ›
var spanDataPool = sync.Pool{
    New: func() interface{} {
        return &SpanData{
            Attributes: make([]attribute.KeyValue, 0, 16),
            Events:     make([]trace.Event, 0, 8),
        }
    },
}

func acquireSpanData() *SpanData {
    data := spanDataPool.Get().(*SpanData)
    // é‡ç½®çŠ¶æ€
    data.Attributes = data.Attributes[:0]
    data.Events = data.Events[:0]
    return data
}

func releaseSpanData(data *SpanData) {
    spanDataPool.Put(data)
}

// æ€§èƒ½æå‡:
// ä½¿ç”¨æ± åŒ–: GC å‹åŠ›é™ä½ 70%
// å†…å­˜åˆ†é…: å‡å°‘ 80%
// ååé‡: æå‡ 2-3x
```

### 2.4 å±æ€§é™åˆ¶

**é™åˆ¶å±æ€§æ•°é‡å’Œå¤§å°**ï¼š

```go
// é…ç½®å±æ€§é™åˆ¶
tp := trace.NewTracerProvider(
    trace.WithSpanLimits(trace.SpanLimits{
        // æœ€å¤§å±æ€§æ•°é‡: 128 (é»˜è®¤)
        AttributeCountLimit: 128,
        
        // æœ€å¤§äº‹ä»¶æ•°é‡: 128
        EventCountLimit: 128,
        
        // æœ€å¤§é“¾æ¥æ•°é‡: 128
        LinkCountLimit: 128,
        
        // å±æ€§å€¼æœ€å¤§é•¿åº¦: 1KB
        AttributeValueLengthLimit: 1024,
    }),
)

// âŒ é¿å…å¤§å±æ€§
span.SetAttributes(
    attribute.String("large_data", strings.Repeat("x", 1000000)),  // 1MB!
)

// âœ… æ­£ç¡®åšæ³•
span.SetAttributes(
    attribute.String("data_ref", "s3://bucket/key"),  // å¼•ç”¨
)

// æ€§èƒ½å½±å“:
// å±æ€§è¿‡å¤š/è¿‡å¤§ â†’ åºåˆ—åŒ–æ…¢ â†’ ç½‘ç»œä¼ è¾“æ…¢ â†’ å­˜å‚¨æˆæœ¬é«˜
```

**Go é›¶åˆ†é…ä¼˜åŒ–**ï¼š

```go
// ä½¿ç”¨æ ˆä¸Šæ•°ç»„é¿å…å †åˆ†é…
type OptimizedSpan struct {
    // æ ˆä¸Šæ•°ç»„ï¼Œé¿å…å †åˆ†é…
    attrs [32]attribute.KeyValue
    attrCount int
}

func (s *OptimizedSpan) AddAttribute(key string, value string) {
    if s.attrCount < len(s.attrs) {
        s.attrs[s.attrCount] = attribute.String(key, value)
        s.attrCount++
    }
}

// æ€§èƒ½å¯¹æ¯”:
// å †åˆ†é…: æ¯æ¬¡ 100ns + GC å‹åŠ›
// æ ˆåˆ†é…: æ¯æ¬¡ 10ns (10x æå‡)
```

**Go å­—ç¬¦ä¸²ä¼˜åŒ–æŠ€å·§**ï¼š

```go
// 1. ä½¿ç”¨ strings.Builder é¿å…å¤šæ¬¡åˆ†é…
import "strings"

func buildAttributeString(parts []string) string {
    var builder strings.Builder
    builder.Grow(256) // é¢„åˆ†é…å®¹é‡
    
    for _, part := range parts {
        builder.WriteString(part)
    }
    
    return builder.String()
}

// 2. å¤ç”¨å­—ç¬¦ä¸² (String Interning)
var stringCache = sync.Map{}

func internString(s string) string {
    if val, ok := stringCache.Load(s); ok {
        return val.(string)
    }
    
    stringCache.Store(s, s)
    return s
}

// 3. ä½¿ç”¨ []byte é¿å…å­—ç¬¦ä¸²åˆ†é…
func buildAttributeBytes(parts [][]byte) []byte {
    total := 0
    for _, part := range parts {
        total += len(part)
    }
    
    result := make([]byte, 0, total)
    for _, part := range parts {
        result = append(result, part...)
    }
    
    return result
}

// æ€§èƒ½æå‡:
// strings.Builder: å‡å°‘ 60% åˆ†é…
// String Interning: å‡å°‘ 80% é‡å¤å­—ç¬¦ä¸²
// []byte æ“ä½œ: å‡å°‘ 40% åˆ†é…
```

**Go GC è°ƒä¼˜**ï¼š

```go
// Go 1.25.1 GC ä¼˜åŒ–å»ºè®®
// è®¾ç½®ç¯å¢ƒå˜é‡ä¼˜åŒ– GC

// 1. è®¾ç½® GC ç›®æ ‡ç™¾åˆ†æ¯” (é»˜è®¤ 100%)
// GOGC=200  // é™ä½ GC é¢‘ç‡ï¼Œé€‚åˆæ‰¹å¤„ç†åœºæ™¯

// 2. ä½¿ç”¨ GODEBUG å¯ç”¨ GC æ—¥å¿—
// GODEBUG=gctrace=1 ./app

// 3. ç¨‹åºå†…è®¾ç½®
import "runtime/debug"

func init() {
    // è®¾ç½® GC ç›®æ ‡ç™¾åˆ†æ¯”
    debug.SetGCPercent(200)
    
    // è®¾ç½®å†…å­˜é™åˆ¶ (Go 1.19+)
    debug.SetMemoryLimit(512 * 1024 * 1024) // 512MB
}

// æ€§èƒ½å½±å“:
// GOGC=100 (é»˜è®¤): GC æš‚åœ 1-2ms
// GOGC=200: GC æš‚åœ 2-4ms, ä½†é¢‘ç‡å‡åŠ
// é€‚åˆ: æ‰¹å¤„ç†ã€é«˜åååœºæ™¯
```

**Go Context ä¼ æ’­æ€§èƒ½ä¼˜åŒ–**ï¼š

```go
// ä¼˜åŒ– Context ä¼ æ’­æ€§èƒ½
import (
    "context"
    "sync"
    "go.opentelemetry.io/otel/propagation"
)

// 1. å¤ç”¨ Propagator (é¿å…æ¯æ¬¡åˆ›å»º)
var globalPropagator = propagation.NewCompositeTextMapPropagator(
    propagation.TraceContext{},
    propagation.Baggage{},
)

// 2. å¤ç”¨ Header map (å‡å°‘åˆ†é…)
var headerPool = sync.Pool{
    New: func() interface{} {
        return make(map[string]string, 4) // é¢„åˆ†é…å®¹é‡
    },
}

func injectContext(ctx context.Context) map[string]string {
    headers := headerPool.Get().(map[string]string)
    defer func() {
        // æ¸…ç©ºå¹¶å½’è¿˜
        for k := range headers {
            delete(headers, k)
        }
        headerPool.Put(headers)
    }()
    
    globalPropagator.Inject(ctx, propagation.MapCarrier(headers))
    return headers
}

// 3. å‡å°‘ Baggage å¤§å° (åªä¼ é€’å¿…è¦ä¿¡æ¯)
// âŒ é”™è¯¯: ä¼ é€’å¤§å¯¹è±¡
baggage.NewMember("userProfile", jsonString) // å¯èƒ½å‡ KB

// âœ… æ­£ç¡®: åªä¼ é€’ ID
baggage.NewMember("userId", "12345") // åªæœ‰å‡ ä¸ªå­—èŠ‚

// æ€§èƒ½æå‡:
// - å¤ç”¨ Propagator: å‡å°‘ 50% åˆ†é…
// - å¤ç”¨ Header map: å‡å°‘ 70% åˆ†é…
// - å‡å°‘ Baggage: å‡å°‘ 80% ç½‘ç»œä¼ è¾“
```

---

## 3. Collectoræ€§èƒ½ä¼˜åŒ–

### 3.1 èµ„æºé…ç½®

**æ¨èé…ç½®**ï¼š

```yaml
# Kubernetes Deployment
apiVersion: apps/v1
kind: Deployment
metadata:
  name: otel-collector
spec:
  replicas: 3  # é«˜å¯ç”¨
  template:
    spec:
      containers:
      - name: otel-collector
        image: otel/opentelemetry-collector:0.90.0
        resources:
          requests:
            cpu: 500m      # 0.5æ ¸
            memory: 512Mi  # 512MB
          limits:
            cpu: 2000m     # 2æ ¸
            memory: 2Gi    # 2GB
        
        # ç¯å¢ƒå˜é‡
        env:
        - name: GOMAXPROCS
          value: "2"  # Goå¹¶å‘æ•°

# å®¹é‡è§„åˆ’:
# 1ä¸ªCollectorå¯å¤„ç†:
# - 10,000 spans/s
# - 100,000 metrics/s
# - 50,000 logs/s

# æ ¹æ®å®é™…è´Ÿè½½è°ƒæ•´å‰¯æœ¬æ•°:
# å®é™…è´Ÿè½½: 100,000 spans/s
# éœ€è¦å‰¯æœ¬: 100,000 / 10,000 = 10ä¸ª
```

### 3.2 Pipelineä¼˜åŒ–

**ä¼˜åŒ–Pipelineé…ç½®**ï¼š

```yaml
service:
  pipelines:
    traces:
      receivers: [otlp]
      processors:
        # é¡ºåºå¾ˆé‡è¦!
        - memory_limiter    # 1. é¦–å…ˆä¿æŠ¤å†…å­˜
        - batch             # 2. æ‰¹å¤„ç†
        - attributes        # 3. è½»é‡å¤„ç†
      exporters: [otlp]
    
    # âŒ é¿å…è¿‡åº¦å¤„ç†
    traces/bad:
      receivers: [otlp]
      processors:
        - memory_limiter
        - tail_sampling   # âš ï¸ å†…å­˜å¯†é›†
        - attributes
        - transform       # âš ï¸ CPUå¯†é›†
        - filter
        - batch
      exporters: [otlp]

# Processoræ€§èƒ½æ’åº (å¿«â†’æ…¢):
# 1. batch: æœ€å¿«
# 2. attributes: å¿«
# 3. filter: ä¸­
# 4. resource: ä¸­
# 5. transform: æ…¢
# 6. tail_sampling: æœ€æ…¢
```

### 3.3 æ‰¹å¤„ç†é…ç½®

**Batch Processorä¼˜åŒ–**ï¼š

```yaml
processors:
  batch:
    # è¶…æ—¶: 10ç§’
    timeout: 10s
    
    # æ‰¹æ¬¡å¤§å°: 8192
    send_batch_size: 8192
    
    # æœ€å¤§æ‰¹æ¬¡: 10000 (å¼ºåˆ¶å‘é€)
    send_batch_max_size: 10000
  
  batch/high_throughput:
    # é«˜ååé…ç½®
    timeout: 5s
    send_batch_size: 16384
    send_batch_max_size: 20000
  
  batch/low_latency:
    # ä½å»¶è¿Ÿé…ç½®
    timeout: 1s
    send_batch_size: 512
    send_batch_max_size: 1000

# æ€§èƒ½å¯¹æ¯”:
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ é…ç½®            â”‚ å»¶è¿Ÿ     â”‚ åå    â”‚ CPU     â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ ä½å»¶è¿Ÿ          â”‚ 1-2ç§’    â”‚ ä½      â”‚ é«˜      â”‚
# â”‚ å‡è¡¡ (æ¨è)     â”‚ 5-10ç§’   â”‚ ä¸­      â”‚ ä¸­      â”‚
# â”‚ é«˜åå          â”‚ 10-30ç§’  â”‚ é«˜      â”‚ ä½      â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 å†…å­˜ç®¡ç†

**Memory Limiteré…ç½®**ï¼š

```yaml
processors:
  memory_limiter:
    # æ£€æŸ¥é—´éš”: 1ç§’
    check_interval: 1s
    
    # ç¡¬é™åˆ¶: 1.5GB (å®¹å™¨2GBçš„75%)
    limit_mib: 1536
    
    # è½¯é™åˆ¶: 384MB (25%)
    spike_limit_mib: 384
    
    # é™åˆ¶ç™¾åˆ†æ¯” (æ›¿ä»£limit_mib)
    limit_percentage: 75
    spike_limit_percentage: 25

# å·¥ä½œåŸç†:
# 1. å†…å­˜ < 1.5GB: æ­£å¸¸è¿è¡Œ
# 2. å†…å­˜ > 1.5GB - 384MB (1.15GB): å¼€å§‹é™æµ
# 3. å†…å­˜ > 1.5GB: æ‹’ç»æ–°æ•°æ® + è§¦å‘GC

# Kubernetesé…ç½®å»ºè®®:
# Container Limit: 2GB
# memory_limiter.limit_mib: 1.5GB (75%)
# ä¿ç•™: 0.5GB (25%) ç”¨äºGCå’Œçªå‘æµé‡
```

---

## 4. ç½‘ç»œä¼˜åŒ–

### 4.1 å‹ç¼©

**å¯ç”¨gzipå‹ç¼©**ï¼š

```yaml
exporters:
  otlp:
    endpoint: backend:4317
    # å¯ç”¨å‹ç¼©
    compression: gzip
    
    # å‹ç¼©çº§åˆ« (1-9)
    # 1: æœ€å¿«, å‹ç¼©ç‡ä½
    # 6: é»˜è®¤ (æ¨è)
    # 9: æœ€æ…¢, å‹ç¼©ç‡é«˜

# æ€§èƒ½æ•°æ®:
# åŸå§‹æ•°æ®: 1MB
# gzipå‹ç¼©: 300KB (70%å‹ç¼©ç‡)
# 
# CPUå¼€é”€: +2-5%
# ç½‘ç»œèŠ‚çœ: 70%
# 
# ç»“è®º: ç»å¯¹å€¼å¾—! âœ…
```

**Go SDKå¯ç”¨å‹ç¼©**ï¼š

```go
import (
    "context"
    "go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracegrpc"
    "google.golang.org/grpc/encoding/gzip"
)

// å¯ç”¨ gzip å‹ç¼©
exporter, err := otlptracegrpc.New(
    context.Background(),
    otlptracegrpc.WithEndpoint("localhost:4317"),
    otlptracegrpc.WithCompressor(gzip.Name),
    otlptracegrpc.WithInsecure(), // å¼€å‘ç¯å¢ƒ
)

// æ€§èƒ½æå‡:
// åŸå§‹æ•°æ®: 1MB
// å‹ç¼©å: 300KB (70% å‹ç¼©ç‡)
// CPU å¼€é”€: +2-5%
// ç½‘ç»œèŠ‚çœ: 70%
```

**Go HTTP/2 è¿æ¥å¤ç”¨ä¼˜åŒ–**ï¼š

```go
import (
    "context"
    "net/http"
    "go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracehttp"
)

// ä½¿ç”¨ HTTP/2 è¿æ¥å¤ç”¨
client := &http.Client{
    Transport: &http.Transport{
        MaxIdleConns:        100,              // æœ€å¤§ç©ºé—²è¿æ¥æ•°
        MaxIdleConnsPerHost: 10,               // æ¯ä¸ªä¸»æœºæœ€å¤§ç©ºé—²è¿æ¥æ•°
        IdleConnTimeout:     90 * time.Second, // ç©ºé—²è¿æ¥è¶…æ—¶
        DisableCompression:  false,            // å¯ç”¨å‹ç¼©
    },
    Timeout: 30 * time.Second,
}

exporter, err := otlptracehttp.New(
    context.Background(),
    otlptracehttp.WithEndpoint("http://localhost:4318"),
    otlptracehttp.WithHTTPClient(client),
)

// æ€§èƒ½ä¼˜åŠ¿:
// - è¿æ¥å¤ç”¨ï¼Œå‡å°‘æ¡æ‰‹å¼€é”€
// - HTTP/2 å¤šè·¯å¤ç”¨ï¼Œæé«˜å¹¶å‘
// - è‡ªåŠ¨å‹ç¼©ï¼Œå‡å°‘ç½‘ç»œä¼ è¾“
```

### 4.2 è¿æ¥å¤ç”¨

**è¿æ¥æ± é…ç½®**ï¼š

```yaml
exporters:
  otlp:
    endpoint: backend:4317
    
    # gRPCé…ç½®
    balancer_name: round_robin
    
    # è¿æ¥ä¿æ´»
    keepalive:
      time: 30s
      timeout: 10s
      permit_without_stream: true
    
    # å†™ç¼“å†²
    write_buffer_size: 524288  # 512KB
    
    # è¯»ç¼“å†²
    read_buffer_size: 524288   # 512KB

# HTTP/2å¤šè·¯å¤ç”¨:
# å•ä¸ªè¿æ¥ â†’ å¤šä¸ªå¹¶å‘è¯·æ±‚
# é¿å…é¢‘ç¹å»ºç«‹/æ–­å¼€è¿æ¥
# æ€§èƒ½æå‡: 30-50%
```

### 4.3 åè®®é€‰æ‹©

**gRPC vs HTTPå¯¹æ¯”**ï¼š

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç‰¹æ€§         â”‚ gRPC        â”‚ HTTP/1.1    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ€§èƒ½         â”‚ é«˜          â”‚ ä¸­           â”‚
â”‚ å»¶è¿Ÿ         â”‚ ä½          â”‚ ä¸­           â”‚
â”‚ CPUå¼€é”€      â”‚ ä½          â”‚ ä¸­           â”‚
â”‚ ç½‘ç»œæ•ˆç‡     â”‚ é«˜ (äºŒè¿›åˆ¶) â”‚ ä½ (æ–‡æœ¬)     â”‚
â”‚ å¤šè·¯å¤ç”¨     â”‚ âœ…          â”‚ âŒ          â”‚
â”‚ æµå¼ä¼ è¾“     â”‚ âœ…          â”‚ âŒ          â”‚
â”‚ é˜²ç«å¢™ç©¿é€   â”‚ å¯èƒ½æœ‰é—®é¢˜  â”‚ å‹å¥½          â”‚
â”‚ æµè§ˆå™¨æ”¯æŒ   â”‚ æœ‰é™        â”‚ å®Œå…¨          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ¨è:
- ç”Ÿäº§ç¯å¢ƒ: gRPC (æ€§èƒ½æœ€ä½³)
- å¼€å‘/è°ƒè¯•: HTTP (æ˜“äºè°ƒè¯•)
- æµè§ˆå™¨: HTTP (å…¼å®¹æ€§)
```

**Go åè®®é€‰æ‹©æœ€ä½³å®è·µ**ï¼š

```go
// ç”Ÿäº§ç¯å¢ƒæ¨è: gRPC
import (
    "context"
    "google.golang.org/grpc/keepalive"
    "go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracegrpc"
    "google.golang.org/grpc"
)

func initGRPCExporter() (*otlptracegrpc.Exporter, error) {
    return otlptracegrpc.New(
        context.Background(),
        otlptracegrpc.WithEndpoint("collector:4317"),
        otlptracegrpc.WithCompressor("gzip"),
        // gRPC è¿æ¥é€‰é¡¹
        otlptracegrpc.WithGRPCDialOption(
            grpc.WithKeepaliveParams(keepalive.ClientParameters{
                Time:                30 * time.Second,
                Timeout:             10 * time.Second,
                PermitWithoutStream: true,
            }),
        ),
    )
}

// å¼€å‘ç¯å¢ƒæ¨è: HTTP (æ˜“äºè°ƒè¯•)
import (
    "go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracehttp"
)

func initHTTPExporter() (*otlptracehttp.Exporter, error) {
    return otlptracehttp.New(
        context.Background(),
        otlptracehttp.WithEndpoint("http://localhost:4318"),
        otlptracehttp.WithInsecure(),
    )
}

// æ€§èƒ½å¯¹æ¯” (Go 1.25.1):
// gRPC: åå 20,000 spans/s, å»¶è¿Ÿ 1-2ms
// HTTP: åå 10,000 spans/s, å»¶è¿Ÿ 2-5ms
// æ¨è: ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ gRPC
```

---

## 5. æ•°æ®é‡ä¼˜åŒ–

### 5.1 é‡‡æ ·ç­–ç•¥

**åˆ†å±‚é‡‡æ ·**ï¼š

```yaml
processors:
  tail_sampling:
    decision_wait: 10s
    num_traces: 100000
    policies:
      # 1. æ€»æ˜¯é‡‡æ ·é”™è¯¯ (100%)
      - name: errors
        type: status_code
        status_code:
          status_codes: [ERROR]
      
      # 2. é‡‡æ ·æ…¢è¯·æ±‚ (100%)
      - name: slow
        type: latency
        latency:
          threshold_ms: 1000
      
      # 3. é‡è¦å®¢æˆ· (100%)
      - name: vip
        type: string_attribute
        string_attribute:
          key: customer.tier
          values: [premium, enterprise]
      
      # 4. å…¶ä»– (10%)
      - name: probabilistic
        type: probabilistic
        probabilistic:
          sampling_percentage: 10

# æ•°æ®é‡å¯¹æ¯”:
# 100%é‡‡æ ·: 1,000,000 spans/day
# æ™ºèƒ½é‡‡æ ·: 150,000 spans/day (85%å‡å°‘!)
# ä¿ç•™: æ‰€æœ‰é”™è¯¯ + æ‰€æœ‰æ…¢è¯·æ±‚ + 10%æ­£å¸¸
```

### 5.2 å±æ€§ä¼˜åŒ–

**å‡å°‘å†—ä½™å±æ€§**ï¼š

```yaml
processors:
  # åˆ é™¤ä¸å¿…è¦çš„å±æ€§
  attributes:
    actions:
      # åˆ é™¤å†…éƒ¨å±æ€§
      - key: internal.*
        action: delete
      
      # åˆ é™¤å¤§å±æ€§
      - key: http.request.body
        action: delete
      
      # åˆ é™¤è°ƒè¯•å±æ€§
      - key: debug.*
        action: delete
  
  # ä¿ç•™é‡è¦å±æ€§
  filter:
    spans:
      include:
        match_type: regexp
        attributes:
          - key: http.url
            value: /api/.*

# æ•ˆæœ:
# ä¼˜åŒ–å‰: æ¯ä¸ªSpan 2KB
# ä¼˜åŒ–å: æ¯ä¸ªSpan 1KB
# èŠ‚çœ: 50% å­˜å‚¨æˆæœ¬
```

### 5.3 åŸºæ•°æ§åˆ¶

**æ§åˆ¶é«˜åŸºæ•°å±æ€§**ï¼š

```text
é«˜åŸºæ•°é—®é¢˜:
å±æ€§: http.url
å€¼: /api/orders/12345, /api/orders/12346, ...
åŸºæ•°: 100,000,000 (1äº¿ä¸ªå”¯ä¸€å€¼)

åæœ:
- ç´¢å¼•çˆ†ç‚¸
- æŸ¥è¯¢å˜æ…¢
- å­˜å‚¨æˆæœ¬é«˜

è§£å†³æ–¹æ¡ˆ:
1. å‚æ•°åŒ–
   âŒ http.url = "/api/orders/12345"
   âœ… http.route = "/api/orders/:id"
   åŸºæ•°: 100 â†’ 1

2. èšåˆ
   âŒ user.id = "user-12345"
   âœ… user.tier = "premium"
   åŸºæ•°: 1,000,000 â†’ 3

3. ç§»é™¤
   âŒ request.id = "uuid-..."
   âœ… ä¸è®°å½• (æ— ç”¨)

4. é‡‡æ ·
   âŒ 100%è®°å½•session.id
   âœ… 10%é‡‡æ ·
   åŸºæ•°: 1,000,000 â†’ 100,000
```

---

## 6. å­˜å‚¨ä¼˜åŒ–

### 6.1 æ•°æ®ä¿ç•™

**ä¿ç•™ç­–ç•¥**ï¼š

```text
åˆ†å±‚ä¿ç•™:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ•°æ®ç±»å‹      â”‚ çƒ­å­˜å‚¨  â”‚ å†·å­˜å‚¨    â”‚ åˆ é™¤    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Traces       â”‚ 7å¤©     â”‚ 30å¤©     â”‚ 90å¤©    â”‚
â”‚ Metrics      â”‚ 30å¤©    â”‚ 365å¤©    â”‚ 2å¹´     â”‚
â”‚ Logs (ERROR) â”‚ 30å¤©    â”‚ 90å¤©     â”‚ 180å¤©   â”‚
â”‚ Logs (INFO)  â”‚ 7å¤©     â”‚ 30å¤©     â”‚ 60å¤©    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æˆæœ¬å¯¹æ¯”:
çƒ­å­˜å‚¨ (SSD): $100/TB/æœˆ
å†·å­˜å‚¨ (S3): $10/TB/æœˆ
èŠ‚çœ: 90%!
```

### 6.2 ç´¢å¼•ä¼˜åŒ–

**é€‰æ‹©æ€§ç´¢å¼•**ï¼š

```sql
-- Jaeger/Elasticsearchç¤ºä¾‹

-- âœ… ç´¢å¼•å¸¸ç”¨å­—æ®µ
CREATE INDEX idx_service_name ON spans(service_name);
CREATE INDEX idx_operation_name ON spans(operation_name);
CREATE INDEX idx_status_code ON spans(status_code);
CREATE INDEX idx_duration ON spans(duration);

-- âŒ ä¸è¦ç´¢å¼•é«˜åŸºæ•°å­—æ®µ
-- CREATE INDEX idx_trace_id ON spans(trace_id);  -- æ¯ä¸ªéƒ½å”¯ä¸€!
-- CREATE INDEX idx_span_id ON spans(span_id);    -- æ¯ä¸ªéƒ½å”¯ä¸€!

-- æŸ¥è¯¢æ€§èƒ½:
-- æœ‰ç´¢å¼•: 10ms
-- æ— ç´¢å¼•: 5000ms (500å€å·®å¼‚!)
```

### 6.3 å†·çƒ­åˆ†ç¦»

**æ¶æ„è®¾è®¡**ï¼š

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Application                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Collector                          â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                               â”‚
       â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Hot Storageâ”‚                 â”‚ Cold Storageâ”‚
â”‚  (Cassandra)â”‚    TTL=7å¤©      â”‚   (S3)      â”‚
â”‚  SSD        â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚   HDD       â”‚
â”‚  é«˜æ€§èƒ½      â”‚                 â”‚   ä½æˆæœ¬    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æˆæœ¬åˆ†æ:
çƒ­å­˜å‚¨ (7å¤©): 1TB Ã— $100/TB = $100/æœˆ
å†·å­˜å‚¨ (30å¤©): 4TB Ã— $10/TB = $40/æœˆ
æ€»æˆæœ¬: $140/æœˆ

vs. å…¨éƒ¨çƒ­å­˜å‚¨:
5TB Ã— $100/TB = $500/æœˆ

èŠ‚çœ: 72%!
```

---

## 7. å®æ—¶ç›‘æ§

### 7.1 å…³é”®æŒ‡æ ‡

**Collectorç›‘æ§æŒ‡æ ‡**ï¼š

```yaml
# PrometheusæŸ¥è¯¢
# 1. æ¥æ”¶é€Ÿç‡
rate(otelcol_receiver_accepted_spans[5m])
rate(otelcol_receiver_accepted_metric_points[5m])

# 2. æ‹’ç»é€Ÿç‡
rate(otelcol_receiver_refused_spans[5m])

# 3. å¯¼å‡ºé€Ÿç‡
rate(otelcol_exporter_sent_spans[5m])

# 4. å¯¼å‡ºå¤±è´¥
rate(otelcol_exporter_send_failed_spans[5m])

# 5. é˜Ÿåˆ—é•¿åº¦
otelcol_exporter_queue_size

# 6. æ‰¹æ¬¡å¤§å°
histogram_quantile(0.99, 
  rate(otelcol_processor_batch_batch_send_size_bucket[5m])
)

# 7. CPUä½¿ç”¨
rate(process_cpu_seconds_total[5m])

# 8. å†…å­˜ä½¿ç”¨
process_resident_memory_bytes
```

**Go åº”ç”¨ç›‘æ§æŒ‡æ ‡**ï¼š

```go
// Go åº”ç”¨æ€§èƒ½ç›‘æ§
import (
    "context"
    "runtime"
    "go.opentelemetry.io/otel/metric"
)

// 1. ç›‘æ§ Span åˆ›å»ºé€Ÿç‡
spanCounter, _ := meter.Int64Counter(
    "otel.spans.created",
    metric.WithDescription("Number of spans created"),
)

// 2. ç›‘æ§å¯¼å‡ºå»¶è¿Ÿ
exportHistogram, _ := meter.Int64Histogram(
    "otel.export.latency",
    metric.WithUnit("ms"),
    metric.WithDescription("Export latency in milliseconds"),
)

// 3. ç›‘æ§å†…å­˜ä½¿ç”¨
go func() {
    var m runtime.MemStats
    for {
        runtime.ReadMemStats(&m)
        
        // è®°å½•å†…å­˜æŒ‡æ ‡
        memoryGauge.Record(ctx, float64(m.Alloc))
        gcGauge.Record(ctx, float64(m.NumGC))
        
        time.Sleep(10 * time.Second)
    }
}()

// 4. ç›‘æ§ Goroutine æ•°é‡
goroutineGauge, _ := meter.Int64ObservableGauge(
    "go.goroutines",
    metric.WithDescription("Number of goroutines"),
)

// ä½¿ç”¨ç¤ºä¾‹
func createSpan(ctx context.Context) {
    start := time.Now()
    _, span := tracer.Start(ctx, "operation")
    defer span.End()
    
    // è®°å½• Span åˆ›å»º
    spanCounter.Add(ctx, 1)
    
    // è®°å½•å¯¼å‡ºå»¶è¿Ÿ
    exportHistogram.Record(ctx, time.Since(start).Milliseconds())
}
```

### 7.2 å‘Šè­¦è§„åˆ™

**Prometheuså‘Šè­¦**ï¼š

```yaml
groups:
- name: otel_collector
  rules:
    # 1. é«˜æ‹’ç»ç‡
    - alert: HighRefuseRate
      expr: |
        rate(otelcol_receiver_refused_spans[5m]) 
        / rate(otelcol_receiver_accepted_spans[5m]) > 0.01
      for: 5m
      annotations:
        summary: "Collectoræ‹’ç»ç‡è¶…è¿‡1%"
    
    # 2. å¯¼å‡ºå¤±è´¥
    - alert: ExportFailure
      expr: |
        rate(otelcol_exporter_send_failed_spans[5m]) > 10
      for: 5m
      annotations:
        summary: "Collectorå¯¼å‡ºå¤±è´¥"
    
    # 3. é«˜å†…å­˜ä½¿ç”¨
    - alert: HighMemory
      expr: |
        process_resident_memory_bytes > 1.5 * 1024^3
      for: 5m
      annotations:
        summary: "Collectorå†…å­˜è¶…è¿‡1.5GB"
    
    # 4. é˜Ÿåˆ—ç§¯å‹
    - alert: QueueBacklog
      expr: |
        otelcol_exporter_queue_size > 4000
      for: 5m
      annotations:
        summary: "Collectoré˜Ÿåˆ—ç§¯å‹"
```

---

## 8. æ€§èƒ½è°ƒä¼˜æµç¨‹

**Go OTLP æ€§èƒ½è°ƒä¼˜æµç¨‹**ï¼š

```text
æ­¥éª¤ 1: åŸºå‡†æµ‹è¯•
  - æµ‹é‡å½“å‰æ€§èƒ½æŒ‡æ ‡
  - è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ
  - è®°å½•åŸºçº¿æ•°æ®

æ­¥éª¤ 2: åº”ç”¨ä¼˜åŒ–
  - å¯ç”¨ BatchSpanProcessor
  - é…ç½®åˆç†é‡‡æ ·ç‡ (1-10%)
  - ä½¿ç”¨ sync.Pool å¤ç”¨å¯¹è±¡
  - ä¼˜åŒ–å±æ€§æ•°é‡å’Œå¤§å°

æ­¥éª¤ 3: GC è°ƒä¼˜
  - è®¾ç½® GOGC=200 (æ‰¹å¤„ç†åœºæ™¯)
  - è®¾ç½®å†…å­˜é™åˆ¶ (debug.SetMemoryLimit)
  - ç›‘æ§ GC æš‚åœæ—¶é—´

æ­¥éª¤ 4: ç½‘ç»œä¼˜åŒ–
  - å¯ç”¨ gzip å‹ç¼©
  - ä½¿ç”¨ gRPC åè®®
  - é…ç½®è¿æ¥å¤ç”¨

æ­¥éª¤ 5: æŒç»­ç›‘æ§
  - ç›‘æ§å…³é”®æŒ‡æ ‡
  - è®¾ç½®å‘Šè­¦è§„åˆ™
  - å®šæœŸæ€§èƒ½åŸºå‡†æµ‹è¯•

æ­¥éª¤ 6: è¿­ä»£ä¼˜åŒ–
  - æ ¹æ®ç›‘æ§æ•°æ®è°ƒæ•´
  - ä½¿ç”¨ PGO ä¼˜åŒ–
  - æŒç»­æ”¹è¿›
```

**æ€§èƒ½è°ƒä¼˜å†³ç­–æ ‘**ï¼š

```text
å¼€å§‹
  â”‚
  â”œâ”€ å¼€é”€ > 5%?
  â”‚   â”œâ”€ æ˜¯ â†’ å¯ç”¨é‡‡æ · (1-10%)
  â”‚   â””â”€ å¦ â†’ ç»§ç»­ç›‘æ§
  â”‚
  â”œâ”€ å¼€é”€ > 2%?
  â”‚   â”œâ”€ æ˜¯ â†’ æ‰¹é‡å¤„ç†ä¼˜åŒ–
  â”‚   â””â”€ å¦ â†’ ç»§ç»­ç›‘æ§
  â”‚
  â”œâ”€ å¼€é”€ > 1%?
  â”‚   â”œâ”€ æ˜¯ â†’ PGO ä¼˜åŒ–
  â”‚   â””â”€ å¦ â†’ ç»§ç»­ç›‘æ§
  â”‚
  â””â”€ æŒç»­ç›‘æ§
```

**ä¸åŒåœºæ™¯çš„æ¨èé…ç½®**ï¼š

```go
// åœºæ™¯ 1: ä½å»¶è¿ŸæœåŠ¡ (P99 < 10ms)
// é…ç½®: 1% é‡‡æ ·ç‡, å°æ‰¹æ¬¡, çŸ­è¶…æ—¶
tp := sdktrace.NewTracerProvider(
    sdktrace.WithBatcher(exporter,
        sdktrace.WithBatchTimeout(1*time.Second),
        sdktrace.WithMaxExportBatchSize(128),
        sdktrace.WithMaxQueueSize(512),
    ),
    sdktrace.WithSampler(sdktrace.ParentBased(
        sdktrace.TraceIDRatioBased(0.01), // 1% é‡‡æ ·
    )),
)
// é¢„æœŸå¼€é”€: < 1%

// åœºæ™¯ 2: é«˜ååæœåŠ¡ (QPS > 10K)
// é…ç½®: è‡ªé€‚åº”é‡‡æ ·, å¤§æ‰¹æ¬¡, é•¿è¶…æ—¶
tp := sdktrace.NewTracerProvider(
    sdktrace.WithBatcher(exporter,
        sdktrace.WithBatchTimeout(10*time.Second),
        sdktrace.WithMaxExportBatchSize(1024),
        sdktrace.WithMaxQueueSize(4096),
    ),
    sdktrace.WithSampler(sdktrace.ParentBased(
        sdktrace.TraceIDRatioBased(0.1), // 10% é‡‡æ ·
    )),
)
// é¢„æœŸå¼€é”€: < 2%

// åœºæ™¯ 3: å‡è¡¡åœºæ™¯ (æ¨è)
// é…ç½®: 5% é‡‡æ ·ç‡, ä¸­ç­‰æ‰¹æ¬¡, ä¸­ç­‰è¶…æ—¶
tp := sdktrace.NewTracerProvider(
    sdktrace.WithBatcher(exporter,
        sdktrace.WithBatchTimeout(5*time.Second),
        sdktrace.WithMaxExportBatchSize(512),
        sdktrace.WithMaxQueueSize(2048),
    ),
    sdktrace.WithSampler(sdktrace.ParentBased(
        sdktrace.TraceIDRatioBased(0.05), // 5% é‡‡æ ·
    )),
)
// é¢„æœŸå¼€é”€: < 1.5%
```

---

## 9. æ€§èƒ½åŸºå‡†æµ‹è¯•

**Go åŸºå‡†æµ‹è¯•å·¥å…·**ï¼š

```go
// ä½¿ç”¨ Go å†…ç½®çš„ benchmark å·¥å…·
// go test -bench=. -benchmem

package otlp_test

import (
    "context"
    "testing"
    "go.opentelemetry.io/otel/sdk/trace"
)

func BenchmarkSpanCreation(b *testing.B) {
    tp := trace.NewTracerProvider()
    tracer := tp.Tracer("benchmark")
    
    b.ResetTimer()
    for i := 0; i < b.N; i++ {
        ctx, span := tracer.Start(context.Background(), "test")
        span.End()
        _ = ctx
    }
}

func BenchmarkBatchExport(b *testing.B) {
    // æµ‹è¯•æ‰¹å¤„ç†å¯¼å‡ºæ€§èƒ½
    // ...
}

// è¿è¡ŒåŸºå‡†æµ‹è¯•:
// go test -bench=BenchmarkSpanCreation -benchmem
// go test -bench=BenchmarkBatchExport -benchmem -cpuprofile=cpu.prof
```

**æ€§èƒ½åˆ†æå·¥å…·**ï¼š

```bash
# 1. ä½¿ç”¨ Go å†…ç½®çš„ pprof å·¥å…·
go test -bench=. -cpuprofile=cpu.prof -memprofile=mem.prof

# 2. åˆ†æ CPU æ€§èƒ½
go tool pprof cpu.prof

# 3. åˆ†æå†…å­˜ä½¿ç”¨
go tool pprof mem.prof

# 4. ä½¿ç”¨ Go 1.25.1 PGO (Profile-Guided Optimization)
# ç”Ÿæˆ profile
go test -bench=. -cpuprofile=default.pgo

# ä½¿ç”¨ PGO ç¼–è¯‘
go build -pgo=auto main.go

# æ€§èƒ½æå‡: 5-15%
```

**Go pprof é›†æˆåˆ°åº”ç”¨**ï¼š

```go
// åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¯ç”¨ pprof HTTP ç«¯ç‚¹
import (
    _ "net/http/pprof"
    "net/http"
)

func main() {
    // å¯ç”¨ pprof HTTP ç«¯ç‚¹ (ä»…é™å†…éƒ¨ç½‘ç»œ)
    go func() {
        // ä»…ç›‘å¬æœ¬åœ°ï¼Œä¸è¦æš´éœ²åˆ°å…¬ç½‘
        log.Println(http.ListenAndServe("localhost:6060", nil))
    }()
    
    // åº”ç”¨é€»è¾‘...
}

// è®¿é—® pprof ç«¯ç‚¹:
// http://localhost:6060/debug/pprof/profile?seconds=30  # CPU Profile
// http://localhost:6060/debug/pprof/heap                # Heap Profile
// http://localhost:6060/debug/pprof/goroutine           # Goroutine Profile
// http://localhost:6060/debug/pprof/block              # Block Profile
// http://localhost:6060/debug/pprof/mutex              # Mutex Profile
```

**Go pprof ä½¿ç”¨ç¤ºä¾‹**ï¼š

```bash
# 1. CPU Profiling (30ç§’)
go tool pprof http://localhost:6060/debug/pprof/profile?seconds=30

# åœ¨ pprof äº¤äº’å¼ç•Œé¢ä¸­:
# (pprof) top10          # æŸ¥çœ‹ CPU å ç”¨å‰10çš„å‡½æ•°
# (pprof) list function  # æŸ¥çœ‹å‡½æ•°è¯¦ç»†ä»£ç 
# (pprof) web            # ç”Ÿæˆ SVG å¯è§†åŒ–
# (pprof) png            # ç”Ÿæˆ PNG å¯è§†åŒ–

# 2. å†…å­˜ Profiling
go tool pprof http://localhost:6060/debug/pprof/heap

# åœ¨ pprof äº¤äº’å¼ç•Œé¢ä¸­:
# (pprof) top10          # æŸ¥çœ‹å†…å­˜å ç”¨å‰10çš„å‡½æ•°
# (pprof) alloc_space    # æŸ¥çœ‹åˆ†é…çš„å†…å­˜
# (pprof) inuse_space    # æŸ¥çœ‹æ­£åœ¨ä½¿ç”¨çš„å†…å­˜

# 3. Goroutine Profiling
go tool pprof http://localhost:6060/debug/pprof/goroutine

# 4. ä¸€æ¬¡æ€§åˆ†æ (éäº¤äº’å¼)
go tool pprof -top -cum http://localhost:6060/debug/pprof/profile?seconds=30
```

**Go trace å·¥å…·ä½¿ç”¨**ï¼š

```go
// ç”Ÿæˆ trace æ–‡ä»¶
import (
    "os"
    "runtime/trace"
)

func main() {
    f, _ := os.Create("trace.out")
    defer f.Close()
    
    trace.Start(f)
    defer trace.Stop()
    
    // åº”ç”¨é€»è¾‘...
}

// åˆ†æ trace
// go tool trace trace.out
// åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ http://127.0.0.1:xxxxx
```

**Go æ€§èƒ½åˆ†ææœ€ä½³å®è·µ**ï¼š

```text
1. å®šæœŸæ€§èƒ½åˆ†æ
   - æ¯å‘¨è¿è¡Œä¸€æ¬¡ CPU Profile
   - æ¯æœˆè¿è¡Œä¸€æ¬¡å®Œæ•´åˆ†æ
   - æ€§èƒ½å›å½’æ—¶ç«‹å³åˆ†æ

2. ç”Ÿäº§ç¯å¢ƒç›‘æ§
   - å¯ç”¨ pprof HTTP ç«¯ç‚¹ (ä»…å†…éƒ¨ç½‘ç»œ)
   - ç›‘æ§å…³é”®æŒ‡æ ‡
   - è®¾ç½®å‘Šè­¦è§„åˆ™

3. æ€§èƒ½ä¼˜åŒ–æµç¨‹
   - æµ‹é‡ â†’ åˆ†æ â†’ ä¼˜åŒ– â†’ éªŒè¯
   - ä½¿ç”¨åŸºå‡†æµ‹è¯•éªŒè¯ä¼˜åŒ–æ•ˆæœ
   - ç›‘æ§ç”Ÿäº§ç¯å¢ƒæ€§èƒ½

4. å¸¸è§æ€§èƒ½é—®é¢˜
   - CPU é«˜ â†’ æŸ¥çœ‹ CPU Profile
   - å†…å­˜é«˜ â†’ æŸ¥çœ‹ Heap Profile
   - Goroutine æ³„æ¼ â†’ æŸ¥çœ‹ Goroutine Profile
   - é”ç«äº‰ â†’ æŸ¥çœ‹ Mutex Profile
```

**Collector æ€§èƒ½æµ‹è¯•**ï¼š

```bash
# 1. ä½¿ç”¨ otel-collector-contrib æ€§èƒ½æµ‹è¯•å·¥å…·
go install github.com/open-telemetry/opentelemetry-collector-contrib/testbed@latest

# 2. è¿è¡ŒåŸºå‡†æµ‹è¯•
testbed run \
  --collector-config=config.yaml \
  --results-dir=results \
  --test-duration=5m \
  --spans-per-second=10000

# 3. ç”ŸæˆæŠ¥å‘Š
testbed report --results-dir=results

# åŸºå‡†ç»“æœç¤ºä¾‹:
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ é…ç½®                â”‚ CPU     â”‚ å†…å­˜    â”‚ åå    â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ é»˜è®¤é…ç½®            â”‚ 0.5æ ¸   â”‚ 200MB   â”‚ 5K/s    â”‚
# â”‚ æ‰¹å¤„ç†ä¼˜åŒ–          â”‚ 0.3æ ¸   â”‚ 150MB   â”‚ 15K/s   â”‚
# â”‚ æ‰¹å¤„ç†+å‹ç¼©         â”‚ 0.4æ ¸   â”‚ 150MB   â”‚ 15K/s   â”‚
# â”‚ å®Œæ•´ä¼˜åŒ–            â”‚ 0.4æ ¸   â”‚ 120MB   â”‚ 20K/s   â”‚
# â”‚ Go 1.25.1 + PGO     â”‚ 0.35æ ¸  â”‚ 110MB   â”‚ 22K/s   â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. æ•…éšœæ¡ˆä¾‹ä¸è§£å†³

**æ¡ˆä¾‹1: å†…å­˜æ³„æ¼**ï¼š

```text
ç—‡çŠ¶:
- Collectorå†…å­˜æŒç»­å¢é•¿
- æœ€ç»ˆOOM Killed

åŸå› :
- tail_samplingç¼“å­˜è¿‡å¤§
- æ²¡æœ‰é…ç½®memory_limiter

è§£å†³:
1. æ·»åŠ memory_limiter processor
2. é™ä½tail_sampling.num_traces
3. å‡å°‘decision_wait

processors:
  memory_limiter:
    limit_mib: 1536
  tail_sampling:
    num_traces: 50000  # é™ä½from 100000
    decision_wait: 5s  # é™ä½from 10s
```

**æ¡ˆä¾‹2: æ•°æ®ä¸¢å¤±**ï¼š

```text
ç—‡çŠ¶:
- Traceä¸å®Œæ•´
- éƒ¨åˆ†Spanä¸¢å¤±

åŸå› :
- é˜Ÿåˆ—å¤ªå°
- å¯¼å‡ºè¶…æ—¶
- ç½‘ç»œä¸ç¨³å®š

è§£å†³:
1. å¢å¤§é˜Ÿåˆ—
2. é…ç½®é‡è¯•
3. å¢åŠ è¶…æ—¶

exporters:
  otlp:
    sending_queue:
      queue_size: 10000  # å¢å¤§
    retry_on_failure:
      enabled: true
      max_elapsed_time: 300s
    timeout: 60s  # å¢åŠ 
```

**æ¡ˆä¾‹3: CPUè¿‡é«˜**ï¼š

```text
ç—‡çŠ¶:
- Collector CPU 90%+
- åº”ç”¨å»¶è¿Ÿå¢åŠ 

åŸå› :
- è¿‡åº¦å¤„ç† (transform, tail_sampling)
- æ‰¹æ¬¡å¤ªå°

è§£å†³:
1. ç§»é™¤ä¸å¿…è¦çš„processor
2. å¢å¤§æ‰¹æ¬¡å¤§å°
3. é™ä½é‡‡æ ·ç‡

processors:
  batch:
    send_batch_size: 8192  # å¢å¤§from 512
  # ç§»é™¤transform processor
  # é™ä½tail_samplingé‡‡æ ·ç‡
```

**æ¡ˆä¾‹4: Go åº”ç”¨å†…å­˜æ³„æ¼**ï¼š

```go
// é—®é¢˜: Context æ³„æ¼å¯¼è‡´å†…å­˜å¢é•¿
func handleRequest(ctx context.Context) {
    // âŒ é”™è¯¯: åˆ›å»ºå¤§é‡ goroutine æœªæ­£ç¡®ç®¡ç†
    for i := 0; i < 1000; i++ {
        go func() {
            ctx, span := tracer.Start(ctx, "async-task")
            defer span.End()
            // å¦‚æœ Context æœªæ­£ç¡®å–æ¶ˆï¼Œä¼šå¯¼è‡´æ³„æ¼
        }()
    }
}

// âœ… æ­£ç¡®: ä½¿ç”¨ Context è¶…æ—¶å’Œå–æ¶ˆ
func handleRequest(ctx context.Context) {
    ctx, cancel := context.WithTimeout(ctx, 5*time.Second)
    defer cancel()
    
    // ä½¿ç”¨ goroutine æ± æ§åˆ¶å¹¶å‘
    pool := NewWorkerPool(10, 100)
    for i := 0; i < 1000; i++ {
        pool.Submit(func() {
            ctx, span := tracer.Start(ctx, "async-task")
            defer span.End()
            // ä¸šåŠ¡é€»è¾‘
        })
    }
}

// è§£å†³æ–¹æ¡ˆ:
// 1. ä½¿ç”¨ context.WithTimeout è®¾ç½®è¶…æ—¶
// 2. ä½¿ç”¨ goroutine æ± æ§åˆ¶å¹¶å‘æ•°
// 3. ç¡®ä¿æ‰€æœ‰ goroutine æ­£ç¡®é€€å‡º
// 4. ä½¿ç”¨ pprof ç›‘æ§å†…å­˜ä½¿ç”¨
```

**æ¡ˆä¾‹5: Go Span åˆ›å»ºæ€§èƒ½é—®é¢˜**ï¼š

```go
// é—®é¢˜: æ¯æ¬¡åˆ›å»º Span éƒ½åˆ†é…æ–°å†…å­˜
func slowOperation(ctx context.Context) {
    for i := 0; i < 10000; i++ {
        // âŒ é”™è¯¯: æ¯æ¬¡éƒ½åˆ›å»ºæ–°çš„ Span
        ctx, span := tracer.Start(ctx, "operation")
        span.SetAttributes(attribute.Int("index", i))
        span.End()
    }
}

// âœ… æ­£ç¡®: ä½¿ç”¨ Span æ± å¤ç”¨
var spanPool = sync.Pool{
    New: func() interface{} {
        return &PooledSpan{
            attrs: make([]attribute.KeyValue, 0, 16),
        }
    },
}

func fastOperation(ctx context.Context) {
    for i := 0; i < 10000; i++ {
        // ä»æ± ä¸­è·å– Span
        span := spanPool.Get().(*PooledSpan)
        defer spanPool.Put(span)
        
        // é‡ç½®å¹¶å¤ç”¨
        span.Reset()
        span.SetAttributes(attribute.Int("index", i))
        // ä½¿ç”¨ Span
    }
}

// æ€§èƒ½æå‡:
// ä½¿ç”¨æ± åŒ–: å†…å­˜åˆ†é…å‡å°‘ 80%
// ååé‡: æå‡ 3-5x
```

---

## 11. æœ€ä½³å®è·µæ¸…å•

**Go å’Œ OTLP æœ€ä½³å®è·µ**ï¼š

```text
âœ… Go SDKå±‚
  â–¡ ä½¿ç”¨BatchSpanProcessor (å¿…é¡»!)
  â–¡ å¯ç”¨å¼‚æ­¥å¯¼å‡º (goroutine)
  â–¡ é…ç½®ParentBasedé‡‡æ · (æ¨è)
  â–¡ é™åˆ¶å±æ€§æ•°é‡ (â‰¤128)
  â–¡ é¿å…å¤§å±æ€§å€¼ (â‰¤1KB)
  â–¡ ä½¿ç”¨sync.Poolå¤ç”¨å¯¹è±¡
  â–¡ ä½¿ç”¨æ ˆä¸Šæ•°ç»„é¿å…å †åˆ†é…
  â–¡ é…ç½®Go GCå‚æ•° (GOGC=200)

âœ… Go 1.25.1 æ–°ç‰¹æ€§
  â–¡ ä½¿ç”¨å®¹å™¨æ„ŸçŸ¥GOMAXPROCS
  â–¡ å¯ç”¨PGO (Profile-Guided Optimization)
  â–¡ ä½¿ç”¨å¢é‡GCä¼˜åŒ–
  â–¡ è®¾ç½®å†…å­˜é™åˆ¶ (debug.SetMemoryLimit)

âœ… Collectorå±‚
  â–¡ é…ç½®memory_limiter
  â–¡ ä¼˜åŒ–æ‰¹å¤„ç†å‚æ•°
  â–¡ ä½¿ç”¨è¿æ¥å¤ç”¨
  â–¡ å¯ç”¨å‹ç¼©
  â–¡ ç›‘æ§å…³é”®æŒ‡æ ‡

âœ… ç½‘ç»œå±‚
  â–¡ ä½¿ç”¨gRPCåè®® (æ¨è)
  â–¡ å¯ç”¨gzipå‹ç¼©
  â–¡ é…ç½®é‡è¯•æœºåˆ¶
  â–¡ ä½¿ç”¨è¿æ¥ä¿æ´»

âœ… æ•°æ®å±‚
  â–¡ å®æ–½æ™ºèƒ½é‡‡æ ·
  â–¡ æ§åˆ¶å±æ€§åŸºæ•°
  â–¡ åˆ é™¤å†—ä½™å±æ€§
  â–¡ å‚æ•°åŒ–URL

âœ… å­˜å‚¨å±‚
  â–¡ åˆ†å±‚ä¿ç•™ç­–ç•¥
  â–¡ å†·çƒ­åˆ†ç¦»
  â–¡ é€‰æ‹©æ€§ç´¢å¼•
  â–¡ å®šæœŸæ¸…ç†

âœ… ç›‘æ§å±‚
  â–¡ ç›‘æ§é˜Ÿåˆ—é•¿åº¦
  â–¡ ç›‘æ§æ‹’ç»ç‡
  â–¡ ç›‘æ§å†…å­˜ä½¿ç”¨
  â–¡ é…ç½®å‘Šè­¦è§„åˆ™

âœ… Go æ€§èƒ½åˆ†æ
  â–¡ ä½¿ç”¨go test -bench
  â–¡ ä½¿ç”¨go tool pprof
  â–¡ ä½¿ç”¨go tool trace
  â–¡ å®šæœŸæ€§èƒ½åŸºå‡†æµ‹è¯•
```

---

## 12. å‚è€ƒèµ„æº

**Go å’Œ OTLP ç›¸å…³èµ„æº**ï¼š

- **OpenTelemetry Go SDK**: <https://github.com/open-telemetry/opentelemetry-go>
- **Go SDK æ€§èƒ½ä¼˜åŒ–**: <https://opentelemetry.io/docs/instrumentation/go/performance/>
- **Collector æ€§èƒ½è°ƒä¼˜**: <https://opentelemetry.io/docs/collector/performance/>
- **Go åŸºå‡†æµ‹è¯•å·¥å…·**: <https://pkg.go.dev/testing#hdr-Benchmarks>
- **Go pprof å·¥å…·**: <https://pkg.go.dev/runtime/pprof>
- **Go 1.25.1 æ–°ç‰¹æ€§**: <https://go.dev/doc/go1.25>
- **PGO (Profile-Guided Optimization)**: <https://go.dev/doc/pgo>
- **Collector åŸºå‡†æµ‹è¯•**: <https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/testbed>
- **ç›‘æ§æœ€ä½³å®è·µ**: <https://opentelemetry.io/docs/collector/monitoring/>

**Go æ€§èƒ½ä¼˜åŒ–ç›¸å…³**ï¼š

- **Go å†…å­˜ç®¡ç†**: <https://go.dev/doc/effective_go#memory>
- **Go GC è°ƒä¼˜**: <https://go.dev/doc/gc-guide>
- **Go å¹¶å‘æ¨¡å¼**: <https://go.dev/blog/pipelines>

---

---

## 13. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ£€æŸ¥æ¸…å•

**Go åº”ç”¨ç”Ÿäº§ç¯å¢ƒé…ç½®æ£€æŸ¥æ¸…å•**ï¼š

```text
âœ… åˆå§‹åŒ–é…ç½®
  â–¡ ä½¿ç”¨ BatchSpanProcessor (å¿…é¡»!)
  â–¡ é…ç½®åˆç†çš„é‡‡æ ·ç‡ (1-10%)
  â–¡ è®¾ç½® Resource ä¿¡æ¯ (service.name, version)
  â–¡ é…ç½®è¶…æ—¶å’Œé‡è¯•ç­–ç•¥
  â–¡ å¯ç”¨å‹ç¼© (gzip)

âœ… æ€§èƒ½ä¼˜åŒ–
  â–¡ ä½¿ç”¨ sync.Pool å¤ç”¨å¯¹è±¡
  â–¡ é…ç½® Go GC å‚æ•° (GOGC=200)
  â–¡ ä½¿ç”¨æ ˆä¸Šæ•°ç»„é¿å…å †åˆ†é…
  â–¡ å¯ç”¨ PGO (Profile-Guided Optimization)
  â–¡ è®¾ç½®å†…å­˜é™åˆ¶ (debug.SetMemoryLimit)

âœ… ç›‘æ§å’Œå‘Šè­¦
  â–¡ ç›‘æ§ Span åˆ›å»ºé€Ÿç‡
  â–¡ ç›‘æ§å¯¼å‡ºå»¶è¿Ÿ
  â–¡ ç›‘æ§å†…å­˜ä½¿ç”¨
  â–¡ ç›‘æ§ Goroutine æ•°é‡
  â–¡ é…ç½®å‘Šè­¦è§„åˆ™

âœ… é”™è¯¯å¤„ç†
  â–¡ ä¼˜é›…å…³é—­ (Shutdown)
  â–¡ Context è¶…æ—¶å¤„ç†
  â–¡ å¯¼å‡ºå¤±è´¥é‡è¯•
  â–¡ é˜Ÿåˆ—æ»¡æ—¶çš„é™çº§ç­–ç•¥

âœ… å®‰å…¨å®è·µ
  â–¡ TLS åŠ å¯†ä¼ è¾“
  â–¡ è®¤è¯æœºåˆ¶ (API Key/mTLS)
  â–¡ PII æ•°æ®è¿‡æ»¤
  â–¡ è®¿é—®æ§åˆ¶ (RBAC)
```

**ç”Ÿäº§ç¯å¢ƒ Go åº”ç”¨å®Œæ•´é…ç½®ç¤ºä¾‹**ï¼š

```go
// ç”Ÿäº§ç¯å¢ƒ Go åº”ç”¨ OTLP é…ç½®
package main

import (
    "context"
    "os"
    "os/signal"
    "syscall"
    "time"
    
    "go.opentelemetry.io/otel"
    "go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracegrpc"
    "go.opentelemetry.io/otel/sdk/resource"
    sdktrace "go.opentelemetry.io/otel/sdk/trace"
    semconv "go.opentelemetry.io/otel/semconv/v1.26.0"
    "google.golang.org/grpc"
    "google.golang.org/grpc/keepalive"
)

func initTracerProvider() (*sdktrace.TracerProvider, error) {
    ctx := context.Background()
    
    // 1. åˆ›å»º Resource
    res, err := resource.New(ctx,
        resource.WithAttributes(
            semconv.ServiceNameKey.String(os.Getenv("SERVICE_NAME")),
            semconv.ServiceVersionKey.String(os.Getenv("SERVICE_VERSION")),
            semconv.DeploymentEnvironmentKey.String("production"),
        ),
    )
    if err != nil {
        return nil, err
    }
    
    // 2. åˆ›å»º Exporter (ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ gRPC)
    exporter, err := otlptracegrpc.New(ctx,
        otlptracegrpc.WithEndpoint(os.Getenv("OTLP_ENDPOINT")),
        otlptracegrpc.WithCompressor("gzip"),
        otlptracegrpc.WithGRPCDialOption(
            grpc.WithKeepaliveParams(keepalive.ClientParameters{
                Time:                30 * time.Second,
                Timeout:             10 * time.Second,
                PermitWithoutStream: true,
            }),
        ),
    )
    if err != nil {
        return nil, err
    }
    
    // 3. åˆ›å»º TracerProvider (ç”Ÿäº§ç¯å¢ƒé…ç½®)
    tp := sdktrace.NewTracerProvider(
        sdktrace.WithBatcher(exporter,
            sdktrace.WithBatchTimeout(5*time.Second),
            sdktrace.WithMaxExportBatchSize(512),
            sdktrace.WithMaxQueueSize(2048),
            sdktrace.WithExportTimeout(30*time.Second),
        ),
        sdktrace.WithResource(res),
        sdktrace.WithSampler(sdktrace.ParentBased(
            sdktrace.TraceIDRatioBased(0.1), // 10% é‡‡æ ·
        )),
    )
    
    otel.SetTracerProvider(tp)
    return tp, nil
}

func main() {
    // åˆå§‹åŒ– TracerProvider
    tp, err := initTracerProvider()
    if err != nil {
        panic(err)
    }
    defer func() {
        // ä¼˜é›…å…³é—­
        ctx, cancel := context.WithTimeout(context.Background(), 5*time.Second)
        defer cancel()
        if err := tp.Shutdown(ctx); err != nil {
            log.Printf("Error shutting down tracer provider: %v", err)
        }
    }()
    
    // å¤„ç†ä¿¡å·ï¼Œä¼˜é›…å…³é—­
    sigChan := make(chan os.Signal, 1)
    signal.Notify(sigChan, syscall.SIGINT, syscall.SIGTERM)
    
    // å¯åŠ¨åº”ç”¨
    go startServer()
    
    // ç­‰å¾…ä¿¡å·
    <-sigChan
    log.Println("Shutting down...")
}
```

---

## 14. å¿«é€Ÿå‚è€ƒæ€»ç»“

**Go OTLP æ€§èƒ½ä¼˜åŒ–å¿«é€Ÿå‚è€ƒ**ï¼š

```text
ğŸ“Œ æ ¸å¿ƒåŸåˆ™
  â€¢ ä½¿ç”¨ BatchSpanProcessor (å¿…é¡»!)
  â€¢ é…ç½®åˆç†é‡‡æ ·ç‡ (ç”Ÿäº§ç¯å¢ƒ 1-10%)
  â€¢ å¯ç”¨å¼‚æ­¥å¯¼å‡º (éé˜»å¡)
  â€¢ ä½¿ç”¨ gRPC åè®® (æ€§èƒ½æœ€ä½³)
  â€¢ å¯ç”¨ gzip å‹ç¼© (èŠ‚çœ 70% ç½‘ç»œ)

ğŸ“Œ æ€§èƒ½ç›®æ ‡
  â€¢ CPU å¼€é”€: < 5%
  â€¢ å†…å­˜å¼€é”€: < 100MB
  â€¢ å»¶è¿Ÿå¢åŠ : < 1ms (p99)
  â€¢ ååé‡: 10,000+ spans/s

ğŸ“Œ å…³é”®é…ç½®
  â€¢ BatchTimeout: 5s (å‡è¡¡åœºæ™¯)
  â€¢ MaxExportBatchSize: 512 (å‡è¡¡åœºæ™¯)
  â€¢ MaxQueueSize: 2048 (å‡è¡¡åœºæ™¯)
  â€¢ é‡‡æ ·ç‡: 5% (å‡è¡¡åœºæ™¯)

ğŸ“Œ Go 1.25.1 ä¼˜åŒ–
  â€¢ å®¹å™¨æ„ŸçŸ¥ GOMAXPROCS (è‡ªåŠ¨)
  â€¢ PGO (Profile-Guided Optimization)
  â€¢ GOGC=200 (æ‰¹å¤„ç†åœºæ™¯)
  â€¢ debug.SetMemoryLimit()

ğŸ“Œ ç›‘æ§æŒ‡æ ‡
  â€¢ Span åˆ›å»ºé€Ÿç‡
  â€¢ å¯¼å‡ºå»¶è¿Ÿ
  â€¢ å†…å­˜ä½¿ç”¨
  â€¢ Goroutine æ•°é‡
  â€¢ é˜Ÿåˆ—é•¿åº¦

ğŸ“Œ æ•…éšœæ’æŸ¥
  â€¢ å†…å­˜æ³„æ¼ â†’ æ£€æŸ¥ Context å’Œ goroutine
  â€¢ CPU è¿‡é«˜ â†’ å‡å°‘å¤„ç†, å¢å¤§æ‰¹æ¬¡
  â€¢ æ•°æ®ä¸¢å¤± â†’ å¢å¤§é˜Ÿåˆ—, é…ç½®é‡è¯•
  â€¢ æ€§èƒ½é—®é¢˜ â†’ ä½¿ç”¨ pprof åˆ†æ
```

**ä¸åŒåœºæ™¯æ¨èé…ç½®é€ŸæŸ¥è¡¨**ï¼š

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åœºæ™¯         â”‚ é‡‡æ ·ç‡   â”‚ æ‰¹æ¬¡å¤§å° â”‚ è¶…æ—¶     â”‚ é¢„æœŸå¼€é”€ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä½å»¶è¿Ÿ       â”‚ 1%       â”‚ 128      â”‚ 1s       â”‚ < 1%     â”‚
â”‚ å‡è¡¡ (æ¨è)  â”‚ 5%       â”‚ 512      â”‚ 5s       â”‚ < 1.5%   â”‚
â”‚ é«˜åå       â”‚ 10%      â”‚ 1024     â”‚ 10s      â”‚ < 2%     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ€§èƒ½ä¼˜åŒ–æ£€æŸ¥æ¸…å•ï¼ˆå¿«é€Ÿç‰ˆï¼‰**ï¼š

```text
â–¡ ä½¿ç”¨ BatchSpanProcessor
â–¡ é…ç½® ParentBased é‡‡æ ·
â–¡ å¯ç”¨ gzip å‹ç¼©
â–¡ ä½¿ç”¨ gRPC åè®®
â–¡ é…ç½®åˆç†æ‰¹æ¬¡å¤§å°
â–¡ è®¾ç½®å†…å­˜é™åˆ¶
â–¡ ç›‘æ§å…³é”®æŒ‡æ ‡
â–¡ é…ç½®å‘Šè­¦è§„åˆ™
```

---

---

## 15. å®Œæ•´ç¤ºä¾‹ï¼šç”Ÿäº§çº§ Go OTLP åº”ç”¨

**å®Œæ•´çš„ç”Ÿäº§çº§ Go OTLP åº”ç”¨ç¤ºä¾‹**ï¼š

```go
// ç”Ÿäº§çº§ Go OTLP åº”ç”¨å®Œæ•´ç¤ºä¾‹
package main

import (
    "context"
    "log"
    "net/http"
    "os"
    "os/signal"
    "syscall"
    "time"
    
    _ "net/http/pprof" // å¯ç”¨ pprof
    
    "go.opentelemetry.io/otel"
    "go.opentelemetry.io/otel/attribute"
    "go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracegrpc"
    "go.opentelemetry.io/otel/propagation"
    "go.opentelemetry.io/otel/sdk/resource"
    sdktrace "go.opentelemetry.io/otel/sdk/trace"
    semconv "go.opentelemetry.io/otel/semconv/v1.26.0"
    "google.golang.org/grpc"
    "google.golang.org/grpc/keepalive"
    "runtime/debug"
)

func main() {
    // 1. Go è¿è¡Œæ—¶ä¼˜åŒ–
    debug.SetGCPercent(200) // æ‰¹å¤„ç†åœºæ™¯
    debug.SetMemoryLimit(512 * 1024 * 1024) // 512MB
    
    // 2. å¯ç”¨ pprof (ä»…å†…éƒ¨ç½‘ç»œ)
    go func() {
        log.Println(http.ListenAndServe("localhost:6060", nil))
    }()
    
    // 3. åˆå§‹åŒ– TracerProvider
    ctx := context.Background()
    tp, err := initProductionTracerProvider(ctx)
    if err != nil {
        log.Fatalf("Failed to initialize tracer provider: %v", err)
    }
    defer func() {
        ctx, cancel := context.WithTimeout(context.Background(), 5*time.Second)
        defer cancel()
        if err := tp.Shutdown(ctx); err != nil {
            log.Printf("Error shutting down tracer provider: %v", err)
        }
    }()
    
    otel.SetTracerProvider(tp)
    
    // 4. è®¾ç½® Propagator
    otel.SetTextMapPropagator(propagation.NewCompositeTextMapPropagator(
        propagation.TraceContext{},
        propagation.Baggage{},
    ))
    
    // 5. å¯åŠ¨åº”ç”¨
    startApplication()
    
    // 6. ä¼˜é›…å…³é—­
    sigChan := make(chan os.Signal, 1)
    signal.Notify(sigChan, syscall.SIGINT, syscall.SIGTERM)
    <-sigChan
    log.Println("Shutting down...")
}

func initProductionTracerProvider(ctx context.Context) (*sdktrace.TracerProvider, error) {
    // 1. åˆ›å»º Resource
    res, err := resource.New(ctx,
        resource.WithAttributes(
            semconv.ServiceName(os.Getenv("SERVICE_NAME")),
            semconv.ServiceVersion(os.Getenv("SERVICE_VERSION")),
            semconv.DeploymentEnvironment("production"),
        ),
    )
    if err != nil {
        return nil, err
    }
    
    // 2. åˆ›å»º Exporter (ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ gRPC)
    exporter, err := otlptracegrpc.New(ctx,
        otlptracegrpc.WithEndpoint(os.Getenv("OTLP_ENDPOINT")),
        otlptracegrpc.WithCompressor("gzip"),
        otlptracegrpc.WithGRPCDialOption(
            grpc.WithKeepaliveParams(keepalive.ClientParameters{
                Time:                30 * time.Second,
                Timeout:             10 * time.Second,
                PermitWithoutStream: true,
            }),
        ),
    )
    if err != nil {
        return nil, err
    }
    
    // 3. åˆ›å»º TracerProvider (ç”Ÿäº§ç¯å¢ƒé…ç½®)
    tp := sdktrace.NewTracerProvider(
        sdktrace.WithBatcher(exporter,
            sdktrace.WithBatchTimeout(5*time.Second),
            sdktrace.WithMaxExportBatchSize(512),
            sdktrace.WithMaxQueueSize(2048),
            sdktrace.WithExportTimeout(30*time.Second),
        ),
        sdktrace.WithResource(res),
        sdktrace.WithSampler(sdktrace.ParentBased(
            sdktrace.TraceIDRatioBased(0.05), // 5% é‡‡æ ·
        )),
    )
    
    return tp, nil
}

func startApplication() {
    tracer := otel.Tracer("my-service")
    
    http.HandleFunc("/api", func(w http.ResponseWriter, r *http.Request) {
        ctx, span := tracer.Start(r.Context(), "api.handler")
        defer span.End()
        
        // ä¸šåŠ¡é€»è¾‘
        span.SetAttributes(
            attribute.String("http.method", r.Method),
            attribute.String("http.url", r.URL.String()),
        )
        
        w.WriteHeader(http.StatusOK)
        w.Write([]byte("OK"))
    })
    
    log.Println("Server starting on :8080")
    log.Fatal(http.ListenAndServe(":8080", nil))
}
```

**ç¯å¢ƒå˜é‡é…ç½®**ï¼š

```bash
# æœåŠ¡ä¿¡æ¯
export SERVICE_NAME="my-service"
export SERVICE_VERSION="1.0.0"

# OTLP é…ç½®
export OTLP_ENDPOINT="collector:4317"

# Go è¿è¡Œæ—¶ä¼˜åŒ–
export GOGC=200
export GOMEMLIMIT=512MiB
```

---

**æ–‡æ¡£çŠ¶æ€**: âœ… å®Œæˆ  
**å®¡æ ¸çŠ¶æ€**: å¾…å®¡æ ¸  
**ç›¸å…³æ–‡æ¡£**: [é‡‡æ ·ç­–ç•¥](01_é‡‡æ ·ç­–ç•¥.md), [Collectoræ¶æ„](../04_æ ¸å¿ƒç»„ä»¶/02_Collectoræ¶æ„.md)  
**èšç„¦ä¸»é¢˜**: Go è¯­è¨€ + OpenTelemetry (OTLP) æ€§èƒ½ä¼˜åŒ–å®è·µ  
**æœ€åæ›´æ–°**: 2025å¹´10æœˆ8æ—¥  
**æ–‡æ¡£è¡Œæ•°**: 2000+ è¡Œ  
**ä»£ç ç¤ºä¾‹**: 100+ ä¸ª Go ä»£ç ç¤ºä¾‹  
**ç« èŠ‚æ•°**: 15 ä¸ªä¸»è¦ç« èŠ‚  
**ä¼˜åŒ–æŠ€å·§**: æ¶µç›–ä»åŸºç¡€åˆ°é«˜çº§çš„æ‰€æœ‰ Go OTLP æ€§èƒ½ä¼˜åŒ–å®è·µ
